Model: <class 'models.ddpg.DDPGAgent'>, Dir: CarRacing-v0
num_envs: 16, state_size: (96, 96, 3), action_size: (3,),

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.98             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, update_freq=NUM_STEPS, decay=EPS_DECAY, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if done[0] or len(self.buffer) >= self.update_freq:
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, _ = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets)]
			self.replay_buffer.extend(list(zip(states, actions, targets)), shuffle=False)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 500 				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import gym
import argparse
import numpy as np
# import gfootball.env as ggym
from collections import deque
from models.ppo import PPOAgent
from models.ddqn import DDQNAgent
from models.ddpg import DDPGAgent
from models.rand import RandomAgent
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, ImgStack, RawStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddqn", "ddpg", "ppo", "rand"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--steps", type=int, default=100000, help="Number of steps to train the agent")
args = parser.parse_args()

gym_envs = ["CartPole-v0", "MountainCar-v0", "Acrobot-v1", "Pendulum-v0", "MountainCarContinuous-v0", "CarRacing-v0", "BipedalWalker-v2", "LunarLander-v2"]
gfb_envs = ["11_vs_11_stochastic", "academy_empty_goal_close"]
env_name = gym_envs[5]

def make_env(env_name=env_name, log=False):
	if env_name in gym_envs: return gym.make(env_name)
	reps = ["pixels", "pixels_gray", "extracted", "simple115"]
	env = ggym.create_environment(env_name=env_name, representation=reps[3], logdir='/football/logs/', render=False)
	env.spec = gym.envs.registration.EnvSpec(env_name + "-v0", max_episode_steps=env.unwrapped._config._scenario_cfg.game_duration)
	if log: print(f"State space: {env.observation_space.shape} \nAction space: {env.action_space.n}")
	return env

class PixelAgent(RandomAgent):
	def __init__(self, state_size, action_size, num_envs, agent, load="", gpu=True, train=True):
		super().__init__(state_size, action_size)
		statemodel = RawStack if len(state_size) == 1 else ImgStack
		self.stack = statemodel(state_size, num_envs, load=load, gpu=gpu)
		self.agent = agent(self.stack.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state = self.stack.get_state(state)
		env_action, action = self.agent.get_env_action(env, state, eps, sample)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.stack.get_state(next_state)
		self.agent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.stack.num_envs if num_envs is None else num_envs
		self.stack.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		if hasattr(self.agent, "network"): self.agent.network.save_model(dirname, name)

def run(model, steps=10000, ports=16, eval_at=1000):
	num_envs = len(ports) if type(ports) == list else min(ports, 64)
	envs = EnvManager(make_env, ports) if type(ports) == list else EnsembleEnv(make_env, ports)
	logger = Logger(model, env_name, num_envs=num_envs, state_size=envs.state_size, action_size=envs.action_size)
	agent = PixelAgent(envs.state_size, envs.action_size, num_envs, model)
	states = envs.reset()
	total_rewards = []
	for s in range(steps):
		agent.reset(num_envs)
		env_actions, actions, states = agent.get_env_action(envs.env, states)
		next_states, rewards, dones, _ = envs.step(env_actions)
		agent.train(states, actions, next_states, rewards, dones)
		states = next_states
		if dones[0]:
			rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(5)]
			test_reward = np.mean(rollouts) - np.std(rollouts)
			total_rewards.append(test_reward)
			agent.save_model(env_name, "checkpoint")
			if env_name in gfb_envs and total_rewards[-1] >= max(total_rewards): agent.save_model(env_name)
			logger.log(f"Step: {s}, Reward: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.agent.eps:.3f})")

if __name__ == "__main__":
	model = DDPGAgent if args.model == "ddpg" else PPOAgent if args.model == "ppo" else DDQNAgent if args.model == "ddqn" else RandomAgent
	if args.selfport is not None:
		EnvWorker(args.selfport, make_env).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, args.steps, args.workerports)
	print(f"Training finished")

Step: 999, Reward: -44.4940 [27.61], Avg: -72.1011 (0.980)
Step: 1999, Reward: -41.0903 [21.91], Avg: -67.5528 (0.960)
Step: 2999, Reward: -54.2979 [11.69], Avg: -67.0321 (0.941)
Step: 3999, Reward: -54.0552 [20.17], Avg: -68.8297 (0.922)
Step: 4999, Reward: -68.6520 [1.28], Avg: -69.0501 (0.904)
Step: 5999, Reward: -59.8741 [12.69], Avg: -69.6362 (0.886)
Step: 6999, Reward: -63.6490 [11.63], Avg: -70.4417 (0.868)
Step: 7999, Reward: -31.7315 [24.32], Avg: -68.6430 (0.851)
Step: 8999, Reward: -35.8633 [7.42], Avg: -65.8251 (0.834)
Step: 9999, Reward: -43.2862 [30.22], Avg: -66.5932 (0.817)
Step: 10999, Reward: -88.0789 [51.02], Avg: -73.1849 (0.801)
Step: 11999, Reward: -69.2966 [17.38], Avg: -74.3091 (0.785)
Step: 12999, Reward: -79.3068 [52.52], Avg: -78.7333 (0.769)
Step: 13999, Reward: -74.8225 [29.42], Avg: -80.5556 (0.754)
Step: 14999, Reward: -63.2595 [15.05], Avg: -80.4060 (0.739)
Step: 15999, Reward: -65.3683 [10.02], Avg: -80.0921 (0.724)
Step: 16999, Reward: -42.2932 [30.18], Avg: -79.6440 (0.709)
Step: 17999, Reward: -76.4481 [37.09], Avg: -81.5270 (0.695)
Step: 18999, Reward: -42.7392 [20.42], Avg: -80.5601 (0.681)
Step: 19580, Reward: -37.1952 [15.48], Avg: -79.1658 (0.668)
Step: 20580, Reward: -52.2776 [26.75], Avg: -79.1592 (0.654)
Step: 21580, Reward: -47.0522 [50.73], Avg: -80.0058 (0.641)
Step: 22580, Reward: -52.5796 [24.71], Avg: -79.8879 (0.628)
Step: 23580, Reward: -54.4373 [15.78], Avg: -79.4849 (0.616)
Step: 24580, Reward: -5.8605 [36.02], Avg: -77.9808 (0.603)
Step: 25580, Reward: -37.7277 [22.26], Avg: -77.2887 (0.591)
Step: 26580, Reward: -52.5340 [22.43], Avg: -77.2027 (0.580)
Step: 27580, Reward: -50.7362 [20.65], Avg: -76.9950 (0.568)
Step: 28580, Reward: -32.4692 [23.95], Avg: -76.2856 (0.557)
Step: 29580, Reward: -19.5444 [23.12], Avg: -75.1649 (0.545)
Step: 30580, Reward: -17.3714 [40.34], Avg: -74.6019 (0.535)
Step: 31580, Reward: -38.0800 [40.47], Avg: -74.7254 (0.524)
Step: 32580, Reward: -13.1577 [40.72], Avg: -74.0937 (0.513)
Step: 33580, Reward: -36.5281 [31.04], Avg: -73.9019 (0.503)
Step: 34580, Reward: -16.6108 [28.77], Avg: -73.0870 (0.493)
Step: 35580, Reward: 13.9405 [38.23], Avg: -71.7315 (0.483)
Step: 36580, Reward: 5.4499 [39.37], Avg: -70.7097 (0.474)
Step: 37580, Reward: -25.9230 [32.29], Avg: -70.3808 (0.464)
Step: 38580, Reward: -39.2739 [28.66], Avg: -70.3179 (0.455)
Step: 39580, Reward: -13.4629 [49.36], Avg: -70.1305 (0.446)
Step: 40580, Reward: 4.0306 [63.70], Avg: -69.8754 (0.437)
Step: 41580, Reward: 6.0019 [42.86], Avg: -69.0892 (0.428)
Step: 42580, Reward: -54.4219 [13.95], Avg: -69.0726 (0.419)
Step: 43580, Reward: -17.6416 [54.27], Avg: -69.1371 (0.411)
Step: 44580, Reward: 44.3230 [87.84], Avg: -68.5678 (0.403)
Step: 45580, Reward: -22.3499 [32.93], Avg: -68.2789 (0.395)
Step: 46580, Reward: 7.2647 [47.65], Avg: -67.6854 (0.387)
Step: 47580, Reward: -27.5628 [9.91], Avg: -67.0560 (0.379)
Step: 48580, Reward: 55.1538 [84.22], Avg: -66.2808 (0.372)
Step: 49580, Reward: 80.3493 [125.45], Avg: -65.8572 (0.364)
Step: 50580, Reward: 59.7378 [62.98], Avg: -64.6294 (0.357)
Step: 51580, Reward: 58.5309 [49.01], Avg: -63.2034 (0.350)
Step: 52580, Reward: 114.2688 [104.21], Avg: -61.8211 (0.343)
Step: 53580, Reward: 31.7739 [120.07], Avg: -62.3114 (0.336)
Step: 54580, Reward: 37.7736 [81.00], Avg: -61.9644 (0.329)
Step: 55580, Reward: 50.9247 [91.58], Avg: -61.5839 (0.323)
Step: 56580, Reward: -19.7889 [35.03], Avg: -61.4652 (0.316)
Step: 57580, Reward: 94.6005 [81.62], Avg: -60.1817 (0.310)
Step: 58580, Reward: 109.8685 [123.32], Avg: -59.3896 (0.304)
Step: 59580, Reward: 79.1939 [116.93], Avg: -59.0287 (0.298)
Step: 60580, Reward: 58.2506 [92.17], Avg: -58.6171 (0.292)
Step: 61580, Reward: 61.9047 [107.90], Avg: -58.4135 (0.286)
Step: 62580, Reward: 13.5047 [56.42], Avg: -58.1674 (0.280)
Step: 63580, Reward: 150.3150 [191.23], Avg: -57.8979 (0.274)
Step: 64580, Reward: 121.2984 [139.53], Avg: -57.2876 (0.269)
Step: 65580, Reward: 231.5428 [183.45], Avg: -55.6909 (0.264)
Step: 66580, Reward: 0.1846 [40.36], Avg: -55.4594 (0.258)
Step: 67580, Reward: 71.6029 [120.23], Avg: -55.3589 (0.253)
Step: 68580, Reward: 119.1247 [151.52], Avg: -55.0262 (0.248)
Step: 69580, Reward: 42.7140 [59.89], Avg: -54.4855 (0.243)
Step: 70580, Reward: 99.1183 [102.79], Avg: -53.7698 (0.238)
Step: 71580, Reward: 276.2089 [131.78], Avg: -51.0170 (0.233)
Step: 72580, Reward: 368.8099 [91.56], Avg: -46.5202 (0.229)
Step: 73580, Reward: 141.1771 [207.19], Avg: -46.7836 (0.224)
Step: 74580, Reward: 242.4835 [181.36], Avg: -45.3449 (0.220)
Step: 75580, Reward: 161.8353 [162.61], Avg: -44.7585 (0.215)
Step: 76580, Reward: 132.3538 [170.99], Avg: -44.6789 (0.211)
Step: 77580, Reward: 461.9984 [133.89], Avg: -39.8996 (0.207)
Step: 78580, Reward: 195.4198 [200.01], Avg: -39.4526 (0.203)
Step: 79580, Reward: 268.8207 [145.14], Avg: -37.4134 (0.199)
Step: 80580, Reward: 288.0353 [220.37], Avg: -36.1162 (0.195)
Step: 81580, Reward: 156.7531 [171.61], Avg: -35.8569 (0.191)
Step: 82580, Reward: 236.8943 [88.53], Avg: -33.6374 (0.187)
Step: 83580, Reward: 530.8441 [169.96], Avg: -28.9407 (0.183)
Step: 84580, Reward: 414.6012 [262.27], Avg: -26.8082 (0.180)
Step: 85580, Reward: 521.2159 [149.68], Avg: -22.1762 (0.176)
Step: 86580, Reward: 448.3780 [105.84], Avg: -17.9841 (0.172)
Step: 87580, Reward: 540.1392 [166.41], Avg: -13.5328 (0.169)
Step: 88580, Reward: 543.3513 [168.63], Avg: -9.1704 (0.166)
Step: 89580, Reward: 687.1575 [111.48], Avg: -2.6721 (0.162)
Step: 90580, Reward: 592.6306 [231.76], Avg: 1.3229 (0.159)
Step: 91580, Reward: 514.8873 [185.93], Avg: 4.8841 (0.156)
Step: 92580, Reward: 426.8834 [251.85], Avg: 6.7137 (0.153)
Step: 93580, Reward: 606.4552 [267.97], Avg: 10.2432 (0.150)
Step: 94580, Reward: 608.7454 [177.62], Avg: 14.6735 (0.147)
Step: 95580, Reward: 654.7298 [76.08], Avg: 20.5483 (0.144)
Step: 96580, Reward: 679.4196 [181.10], Avg: 25.4738 (0.141)
Step: 97580, Reward: 619.3290 [296.99], Avg: 28.5030 (0.138)
Step: 98580, Reward: 611.3881 [163.42], Avg: 32.7401 (0.135)
Step: 99580, Reward: 555.6212 [267.03], Avg: 35.2986 (0.133)
Step: 100580, Reward: 617.5666 [86.39], Avg: 40.2083 (0.130)
Step: 101580, Reward: 775.9948 [73.57], Avg: 46.7006 (0.127)
Step: 102580, Reward: 734.8718 [160.50], Avg: 51.8236 (0.125)
Step: 103580, Reward: 689.2875 [96.05], Avg: 57.0295 (0.122)
Step: 104580, Reward: 583.6512 [200.48], Avg: 60.1357 (0.120)
Step: 105580, Reward: 738.8794 [108.83], Avg: 65.5122 (0.117)
Step: 106580, Reward: 536.3071 [213.85], Avg: 67.9135 (0.115)
Step: 107580, Reward: 770.0339 [120.31], Avg: 73.3006 (0.113)
Step: 108580, Reward: 525.2635 [218.15], Avg: 75.4457 (0.111)
Step: 109580, Reward: 645.5890 [92.36], Avg: 79.7892 (0.108)
Step: 110580, Reward: 557.1959 [209.54], Avg: 82.2024 (0.106)
Step: 111580, Reward: 517.7031 [205.45], Avg: 84.2564 (0.104)
Step: 112580, Reward: 799.6274 [159.39], Avg: 89.1766 (0.102)
Step: 113580, Reward: 619.2362 [237.46], Avg: 91.7433 (0.100)
Step: 114580, Reward: 401.5325 [207.96], Avg: 92.6288 (0.098)
Step: 115580, Reward: 382.9669 [247.22], Avg: 93.0005 (0.096)
Step: 116580, Reward: 678.8275 [181.62], Avg: 96.4552 (0.094)
Step: 117580, Reward: 470.4562 [296.52], Avg: 97.1119 (0.092)
Step: 118580, Reward: 557.6361 [59.45], Avg: 100.4823 (0.090)
Step: 119580, Reward: 840.1565 [31.53], Avg: 106.3834 (0.089)
Step: 120580, Reward: 824.5394 [45.80], Avg: 111.9401 (0.087)
Step: 121580, Reward: 831.0937 [34.39], Avg: 117.5529 (0.085)
Step: 122580, Reward: 853.8613 [40.33], Avg: 123.2113 (0.083)
Step: 123580, Reward: 880.0485 [25.27], Avg: 129.1111 (0.082)
Step: 124580, Reward: 874.3673 [22.18], Avg: 134.8957 (0.080)
Step: 125580, Reward: 872.4600 [21.34], Avg: 140.5800 (0.078)
Step: 126580, Reward: 841.6942 [40.64], Avg: 145.7806 (0.077)
Step: 127580, Reward: 810.7086 [40.00], Avg: 150.6628 (0.075)
Step: 128580, Reward: 872.6710 [29.95], Avg: 156.0276 (0.074)
Step: 129580, Reward: 885.8005 [17.95], Avg: 161.5032 (0.072)
Step: 130580, Reward: 709.2195 [246.45], Avg: 163.8030 (0.071)
Step: 131580, Reward: 789.3408 [121.74], Avg: 167.6196 (0.069)
Step: 132580, Reward: 884.0891 [21.83], Avg: 172.8425 (0.068)
Step: 133580, Reward: 867.4005 [19.13], Avg: 177.8830 (0.067)
Step: 134580, Reward: 874.3676 [59.27], Avg: 182.6031 (0.065)
Step: 135580, Reward: 714.8342 [177.99], Avg: 185.2078 (0.064)
Step: 136580, Reward: 886.3702 [15.92], Avg: 190.2096 (0.063)
Step: 137580, Reward: 907.0813 [23.90], Avg: 195.2311 (0.062)
Step: 138186, Reward: 860.1296 [31.13], Avg: 199.7906 (0.060)
Step: 139186, Reward: 835.6834 [29.29], Avg: 204.1235 (0.059)
Step: 140186, Reward: 898.3797 [15.43], Avg: 208.9378 (0.058)
Step: 141186, Reward: 881.0194 [31.12], Avg: 213.4516 (0.057)
Step: 142186, Reward: 821.1306 [39.22], Avg: 217.4268 (0.056)
Step: 143186, Reward: 852.7597 [22.79], Avg: 221.6806 (0.055)
Step: 144186, Reward: 700.4070 [161.26], Avg: 223.8700 (0.053)
Step: 145186, Reward: 638.9990 [147.37], Avg: 225.7040 (0.052)
Step: 146186, Reward: 551.8113 [267.36], Avg: 226.1036 (0.051)
Step: 147186, Reward: 860.5362 [36.23], Avg: 230.1455 (0.050)
Step: 148186, Reward: 711.6013 [212.76], Avg: 231.9488 (0.049)
Step: 149186, Reward: 816.9679 [132.51], Avg: 234.9655 (0.048)
Step: 150186, Reward: 877.1646 [8.92], Avg: 239.1594 (0.047)
Step: 151186, Reward: 820.7608 [48.26], Avg: 242.6683 (0.046)
Step: 152044, Reward: 888.8569 [21.25], Avg: 246.7528 (0.045)
Step: 153044, Reward: 876.2897 [23.13], Avg: 250.6905 (0.045)
Step: 154044, Reward: 855.2992 [32.71], Avg: 254.3802 (0.044)
Step: 154820, Reward: 816.9004 [104.47], Avg: 257.3164 (0.043)
Step: 155820, Reward: 838.4233 [38.55], Avg: 260.7722 (0.042)
Step: 156820, Reward: 459.7616 [339.76], Avg: 259.8812 (0.041)
Step: 157820, Reward: 880.8086 [32.94], Avg: 263.5793 (0.040)
Step: 158820, Reward: 890.7342 [19.20], Avg: 267.3790 (0.039)
Step: 159820, Reward: 854.6197 [17.57], Avg: 270.9173 (0.039)
Step: 160820, Reward: 884.0789 [12.55], Avg: 274.6248 (0.038)
Step: 161820, Reward: 793.9922 [45.65], Avg: 277.5310 (0.037)
Step: 162820, Reward: 883.2341 [30.08], Avg: 281.0409 (0.036)
Step: 163820, Reward: 877.3087 [10.76], Avg: 284.5895 (0.036)
Step: 164820, Reward: 876.2509 [8.24], Avg: 288.1041 (0.035)
Step: 165820, Reward: 861.1498 [16.71], Avg: 291.4354 (0.034)
Step: 166746, Reward: 900.8364 [24.81], Avg: 294.9151 (0.034)
Step: 167746, Reward: 887.2291 [26.54], Avg: 298.2629 (0.033)
Step: 168418, Reward: 879.4548 [9.42], Avg: 301.6263 (0.032)
Step: 169418, Reward: 377.5913 [271.28], Avg: 300.4840 (0.032)
Step: 170132, Reward: 863.3485 [17.21], Avg: 303.6564 (0.031)
Step: 171132, Reward: 866.7920 [14.18], Avg: 306.8296 (0.030)
Step: 171818, Reward: 740.6285 [137.62], Avg: 308.5318 (0.030)
Step: 172818, Reward: 856.9189 [26.20], Avg: 311.5157 (0.029)
Step: 173627, Reward: 794.8774 [193.98], Avg: 313.1599 (0.029)
Step: 174627, Reward: 876.5595 [34.25], Avg: 316.1494 (0.028)
Step: 175627, Reward: 858.2127 [66.55], Avg: 318.8208 (0.027)
Step: 176627, Reward: 872.0425 [12.21], Avg: 321.8433 (0.027)
Step: 177627, Reward: 888.1339 [34.76], Avg: 324.7962 (0.026)
Step: 178627, Reward: 867.9463 [70.06], Avg: 327.4100 (0.026)
Step: 179627, Reward: 839.9166 [45.16], Avg: 329.9779 (0.025)
Step: 180198, Reward: 871.0181 [77.29], Avg: 332.5120 (0.025)
Step: 181198, Reward: 868.5289 [27.12], Avg: 335.2778 (0.024)
Step: 182069, Reward: 859.5403 [41.73], Avg: 337.8860 (0.024)
Step: 183069, Reward: 894.8632 [28.16], Avg: 340.7292 (0.023)
Step: 184069, Reward: 862.6869 [29.89], Avg: 343.3605 (0.023)
Step: 185069, Reward: 851.9325 [45.69], Avg: 345.8227 (0.022)
Step: 186069, Reward: 761.2903 [100.47], Avg: 347.4894 (0.022)
Step: 187069, Reward: 836.9350 [27.21], Avg: 349.9222 (0.022)
Step: 188069, Reward: 871.5931 [57.73], Avg: 352.3512 (0.021)
Step: 189069, Reward: 875.7741 [33.14], Avg: 354.9048 (0.021)
Step: 189744, Reward: 899.8925 [33.97], Avg: 357.5525 (0.020)
Step: 190744, Reward: 857.2173 [33.38], Avg: 359.9561 (0.020)
Step: 191744, Reward: 867.0226 [18.61], Avg: 362.4610 (0.020)
Step: 192744, Reward: 892.6887 [21.55], Avg: 365.0562 (0.020)
Step: 193468, Reward: 875.6766 [18.80], Avg: 367.5528 (0.020)
Step: 194031, Reward: 873.0975 [7.26], Avg: 370.0693 (0.020)
Step: 194644, Reward: 843.3082 [65.20], Avg: 372.1198 (0.020)
Step: 195644, Reward: 731.0491 [256.79], Avg: 372.6304 (0.020)
Step: 196644, Reward: 899.3817 [34.63], Avg: 375.0788 (0.020)
Step: 197644, Reward: 790.7284 [11.34], Avg: 377.0803 (0.020)
Step: 198644, Reward: 866.1609 [10.83], Avg: 379.4363 (0.020)
Step: 199644, Reward: 862.0502 [20.44], Avg: 381.7018 (0.020)
Step: 200644, Reward: 888.3453 [23.60], Avg: 384.0581 (0.020)
Step: 201644, Reward: 864.5791 [35.02], Avg: 386.2207 (0.020)
Step: 202644, Reward: 854.4272 [19.38], Avg: 388.3890 (0.020)
Step: 203644, Reward: 837.6805 [25.37], Avg: 390.4271 (0.020)
Step: 204644, Reward: 809.4802 [48.40], Avg: 392.2005 (0.020)
Step: 205644, Reward: 853.4744 [9.36], Avg: 394.3525 (0.020)
Step: 206644, Reward: 561.5972 [368.37], Avg: 393.3993 (0.020)
Step: 207644, Reward: 870.3533 [14.09], Avg: 395.5826 (0.020)
Step: 208243, Reward: 904.4481 [26.33], Avg: 397.8480 (0.020)
Step: 209243, Reward: 876.4410 [13.20], Avg: 400.0228 (0.020)
Step: 210243, Reward: 883.8366 [3.69], Avg: 402.2559 (0.020)
Step: 211243, Reward: 861.6174 [34.16], Avg: 404.2245 (0.020)
Step: 212243, Reward: 888.9165 [30.73], Avg: 406.3165 (0.020)
Step: 213243, Reward: 855.6651 [13.51], Avg: 408.3157 (0.020)
Step: 214243, Reward: 853.3573 [27.23], Avg: 410.2235 (0.020)
Step: 215243, Reward: 860.7083 [73.33], Avg: 411.9379 (0.020)
Step: 216243, Reward: 885.4970 [20.69], Avg: 413.9870 (0.020)
Step: 217243, Reward: 878.5804 [25.65], Avg: 415.9643 (0.020)
Step: 218243, Reward: 886.5409 [26.63], Avg: 417.9550 (0.020)
Step: 218910, Reward: 892.4400 [29.17], Avg: 419.9430 (0.020)
Step: 219910, Reward: 822.8262 [67.47], Avg: 421.4337 (0.020)
Step: 220495, Reward: 889.4814 [40.84], Avg: 423.3240 (0.020)
Step: 221495, Reward: 789.1304 [185.83], Avg: 424.1169 (0.020)
Step: 222495, Reward: 751.1144 [152.80], Avg: 424.8809 (0.020)
Step: 223362, Reward: 893.9275 [51.56], Avg: 426.7040 (0.020)
Step: 224362, Reward: 889.0124 [23.07], Avg: 428.6137 (0.020)
Step: 225362, Reward: 893.8011 [34.94], Avg: 430.4763 (0.020)
Step: 225938, Reward: 901.5559 [20.22], Avg: 432.4196 (0.020)
Step: 226777, Reward: 912.4531 [27.53], Avg: 434.3617 (0.020)
Step: 227777, Reward: 890.6562 [24.56], Avg: 436.2068 (0.020)
Step: 228777, Reward: 827.8754 [44.67], Avg: 437.6833 (0.020)
Step: 229777, Reward: 909.5552 [21.83], Avg: 439.5903 (0.020)
Step: 230478, Reward: 788.4415 [109.63], Avg: 440.5996 (0.020)
Step: 231116, Reward: 892.1270 [27.02], Avg: 442.3833 (0.020)
Step: 232116, Reward: 857.9278 [12.02], Avg: 444.0717 (0.020)
Step: 233039, Reward: 862.1557 [21.08], Avg: 445.7258 (0.020)
Step: 234039, Reward: 877.2600 [46.59], Avg: 447.3231 (0.020)
Step: 235039, Reward: 867.9311 [38.53], Avg: 448.9020 (0.020)
Step: 236039, Reward: 893.8932 [22.59], Avg: 450.6403 (0.020)
Step: 237039, Reward: 875.6304 [35.00], Avg: 452.2386 (0.020)
Step: 238039, Reward: 828.5342 [123.88], Avg: 453.2688 (0.020)
Step: 239039, Reward: 829.3296 [72.18], Avg: 454.5041 (0.020)
Step: 240039, Reward: 907.7494 [19.96], Avg: 456.2583 (0.020)
Step: 241039, Reward: 794.3229 [106.25], Avg: 457.1931 (0.020)
Step: 242039, Reward: 861.8805 [35.06], Avg: 458.6775 (0.020)
Step: 243039, Reward: 836.7867 [119.27], Avg: 459.7129 (0.020)
Step: 244039, Reward: 890.8979 [28.24], Avg: 461.3183 (0.020)
Step: 245039, Reward: 693.2746 [217.29], Avg: 461.3765 (0.020)
Step: 246039, Reward: 893.9742 [5.38], Avg: 463.0651 (0.020)
Step: 247039, Reward: 849.0853 [12.22], Avg: 464.5367 (0.020)
Step: 248039, Reward: 904.0100 [20.28], Avg: 466.1806 (0.020)
Step: 249039, Reward: 910.3952 [24.45], Avg: 467.8203 (0.020)
Step: 249779, Reward: 868.4197 [80.44], Avg: 469.0661 (0.020)
Step: 250779, Reward: 871.3163 [36.77], Avg: 470.4827 (0.020)
Step: 251779, Reward: 848.3081 [50.41], Avg: 471.7468 (0.020)
Step: 252779, Reward: 868.8628 [28.62], Avg: 473.1641 (0.020)
Step: 253779, Reward: 890.4406 [28.29], Avg: 474.6545 (0.020)
Step: 254779, Reward: 882.3119 [30.95], Avg: 476.0923 (0.020)
Step: 255779, Reward: 783.5338 [140.22], Avg: 476.7281 (0.020)
Step: 256628, Reward: 806.9233 [82.03], Avg: 477.6682 (0.020)
Step: 257628, Reward: 858.1887 [33.24], Avg: 478.9787 (0.020)
Step: 258628, Reward: 845.8311 [21.53], Avg: 480.2769 (0.020)
Step: 259334, Reward: 874.9530 [31.73], Avg: 481.6362 (0.020)
Step: 259914, Reward: 852.6773 [26.58], Avg: 482.9215 (0.020)
Step: 260914, Reward: 865.7338 [18.42], Avg: 484.2761 (0.020)
Step: 261522, Reward: 847.9557 [62.67], Avg: 485.3910 (0.020)
Step: 262522, Reward: 832.5248 [65.85], Avg: 486.4289 (0.020)
Step: 263522, Reward: 876.8832 [11.17], Avg: 487.8233 (0.020)
Step: 264522, Reward: 886.7451 [28.38], Avg: 489.1806 (0.020)
Step: 265522, Reward: 846.5366 [68.05], Avg: 490.2365 (0.020)
Step: 266522, Reward: 867.4752 [19.05], Avg: 491.5390 (0.020)
Step: 267522, Reward: 896.5463 [29.16], Avg: 492.9008 (0.020)
Step: 268522, Reward: 870.0858 [25.50], Avg: 494.1704 (0.020)
Step: 269032, Reward: 843.9045 [38.84], Avg: 495.2887 (0.020)
Step: 270032, Reward: 896.5822 [15.51], Avg: 496.6714 (0.020)
Step: 271032, Reward: 838.3923 [45.54], Avg: 497.7292 (0.020)
Step: 272032, Reward: 858.9551 [25.98], Avg: 498.9223 (0.020)
Step: 273032, Reward: 757.1266 [92.31], Avg: 499.5106 (0.020)
Step: 274032, Reward: 874.8607 [27.52], Avg: 500.7396 (0.020)
Step: 274638, Reward: 846.3490 [20.77], Avg: 501.8834 (0.020)
Step: 275638, Reward: 883.0529 [35.41], Avg: 503.0966 (0.020)
Step: 276638, Reward: 843.7614 [30.87], Avg: 504.1798 (0.020)
Step: 277638, Reward: 811.1794 [66.95], Avg: 505.0162 (0.020)
Step: 278638, Reward: 843.2910 [14.42], Avg: 506.1407 (0.020)
Step: 279638, Reward: 852.3003 [17.82], Avg: 507.2768 (0.020)
Step: 280638, Reward: 892.2493 [23.87], Avg: 508.5220 (0.020)
Step: 281638, Reward: 881.2924 [34.00], Avg: 509.6862 (0.020)
Step: 282638, Reward: 854.7828 [19.79], Avg: 510.8002 (0.020)
Step: 283638, Reward: 838.8722 [21.45], Avg: 511.8468 (0.020)
Step: 284494, Reward: 857.6848 [34.39], Avg: 512.9061 (0.020)
Step: 285494, Reward: 866.7591 [25.09], Avg: 514.0206 (0.020)
Step: 286494, Reward: 883.6227 [29.32], Avg: 515.1702 (0.020)
Step: 287494, Reward: 850.6873 [62.09], Avg: 516.0908 (0.020)
Step: 288494, Reward: 862.8239 [16.86], Avg: 517.1977 (0.020)
Step: 289494, Reward: 841.8113 [25.27], Avg: 518.1989 (0.020)
Step: 290494, Reward: 867.2540 [46.90], Avg: 519.2061 (0.020)
Step: 291494, Reward: 793.1722 [132.74], Avg: 519.6753 (0.020)
Step: 292494, Reward: 847.3980 [68.02], Avg: 520.5352 (0.020)
Step: 293494, Reward: 893.6852 [40.66], Avg: 521.6325 (0.020)
Step: 294494, Reward: 905.0457 [33.33], Avg: 522.7841 (0.020)
Step: 295494, Reward: 887.0948 [28.67], Avg: 523.8845 (0.020)
Step: 296494, Reward: 844.7645 [20.03], Avg: 524.8677 (0.020)
Step: 297494, Reward: 861.4098 [43.07], Avg: 525.8236 (0.020)
Step: 298494, Reward: 761.8286 [156.21], Avg: 526.0827 (0.020)
Step: 299494, Reward: 875.1228 [16.15], Avg: 527.1600 (0.020)
Step: 300494, Reward: 858.1447 [33.42], Avg: 528.1199 (0.020)
Step: 301439, Reward: 869.8673 [36.60], Avg: 529.1010 (0.020)
Step: 302439, Reward: 827.4544 [43.95], Avg: 529.9164 (0.020)
Step: 303439, Reward: 863.3379 [20.50], Avg: 530.9162 (0.020)
Step: 304439, Reward: 833.7949 [35.40], Avg: 531.7680 (0.020)
Step: 305439, Reward: 793.4317 [53.60], Avg: 532.4286 (0.020)
Step: 306439, Reward: 888.2168 [42.18], Avg: 533.4210 (0.020)
Step: 307439, Reward: 846.1935 [48.52], Avg: 534.2546 (0.020)
Step: 308439, Reward: 862.6902 [30.47], Avg: 535.1916 (0.020)
Step: 309439, Reward: 863.3467 [21.99], Avg: 536.1514 (0.020)
Step: 310439, Reward: 823.5580 [49.99], Avg: 536.8933 (0.020)
Step: 311439, Reward: 885.0612 [29.29], Avg: 537.8867 (0.020)
Step: 312439, Reward: 861.8135 [47.28], Avg: 538.7458 (0.020)
Step: 313439, Reward: 790.3833 [157.89], Avg: 539.0361 (0.020)
Step: 314439, Reward: 919.8851 [26.61], Avg: 540.1294 (0.020)
Step: 315439, Reward: 857.5589 [68.90], Avg: 540.8941 (0.020)
Step: 316353, Reward: 842.3750 [21.73], Avg: 541.7523 (0.020)
Step: 317071, Reward: 861.1102 [26.18], Avg: 542.6488 (0.020)
Step: 318071, Reward: 822.8298 [69.22], Avg: 543.2920 (0.020)
Step: 319071, Reward: 796.5081 [133.36], Avg: 543.6563 (0.020)
Step: 320071, Reward: 864.3510 [12.34], Avg: 544.5907 (0.020)
Step: 321071, Reward: 853.0752 [21.98], Avg: 545.4563 (0.020)
Step: 322071, Reward: 852.6367 [57.04], Avg: 546.2097 (0.020)
Step: 323071, Reward: 749.3460 [99.69], Avg: 546.5203 (0.020)
Step: 324071, Reward: 816.7197 [49.86], Avg: 547.1800 (0.020)
Step: 325071, Reward: 828.3608 [35.40], Avg: 547.9137 (0.020)
Step: 326071, Reward: 877.4401 [18.46], Avg: 548.8395 (0.020)
Step: 327071, Reward: 803.6038 [179.87], Avg: 549.0617 (0.020)
Step: 328071, Reward: 860.0943 [24.12], Avg: 549.9106 (0.020)
Step: 329071, Reward: 863.2176 [16.36], Avg: 550.7865 (0.020)
Step: 330071, Reward: 862.8185 [15.81], Avg: 551.6578 (0.020)
Step: 331071, Reward: 841.2135 [32.06], Avg: 552.4129 (0.020)
Step: 331812, Reward: 839.8696 [7.61], Avg: 553.2312 (0.020)
Step: 332812, Reward: 856.5710 [54.03], Avg: 553.9580 (0.020)
Step: 333812, Reward: 871.9816 [34.64], Avg: 554.7818 (0.020)
Step: 334812, Reward: 846.7634 [19.15], Avg: 555.5726 (0.020)
Step: 335812, Reward: 867.7067 [17.03], Avg: 556.4255 (0.020)
Step: 336812, Reward: 841.5906 [10.19], Avg: 557.2180 (0.020)
Step: 337812, Reward: 883.3355 [38.18], Avg: 558.0454 (0.020)
Step: 338812, Reward: 873.3274 [33.21], Avg: 558.8536 (0.020)
Step: 339812, Reward: 844.3101 [41.60], Avg: 559.5503 (0.020)
Step: 340812, Reward: 850.9636 [58.82], Avg: 560.2130 (0.020)
Step: 341812, Reward: 816.6576 [86.14], Avg: 560.6968 (0.020)
Step: 342812, Reward: 863.3838 [22.24], Avg: 561.4913 (0.020)
Step: 343812, Reward: 829.1745 [14.47], Avg: 562.2066 (0.020)
Step: 344812, Reward: 831.2678 [23.91], Avg: 562.8971 (0.020)
Step: 345812, Reward: 852.3917 [55.64], Avg: 563.5540 (0.020)
Step: 346812, Reward: 841.5091 [24.62], Avg: 564.2636 (0.020)
Step: 347812, Reward: 872.2429 [46.06], Avg: 564.9953 (0.020)
Step: 348812, Reward: 831.9584 [41.26], Avg: 565.6240 (0.020)
Step: 349812, Reward: 858.1519 [21.17], Avg: 566.3778 (0.020)
Step: 350812, Reward: 879.8787 [24.50], Avg: 567.1783 (0.020)
Step: 351812, Reward: 890.0974 [25.63], Avg: 567.9996 (0.020)
Step: 352812, Reward: 858.4740 [19.34], Avg: 568.7465 (0.020)
Step: 353812, Reward: 850.2210 [27.76], Avg: 569.4435 (0.020)
Step: 354812, Reward: 862.1339 [18.20], Avg: 570.1955 (0.020)
Step: 355812, Reward: 871.5776 [12.96], Avg: 570.9836 (0.020)
Step: 356812, Reward: 823.6022 [30.55], Avg: 571.5887 (0.020)
Step: 357812, Reward: 725.0788 [71.93], Avg: 571.8103 (0.020)
Step: 358812, Reward: 855.6115 [22.98], Avg: 572.5171 (0.020)
Step: 359812, Reward: 854.7101 [22.11], Avg: 573.2201 (0.020)
Step: 360812, Reward: 727.0184 [265.44], Avg: 572.9192 (0.020)
Step: 361812, Reward: 859.6348 [87.22], Avg: 573.4554 (0.020)
Step: 362812, Reward: 856.2427 [17.49], Avg: 574.1667 (0.020)
Step: 363812, Reward: 850.9731 [17.11], Avg: 574.8611 (0.020)
Step: 364812, Reward: 792.0641 [203.46], Avg: 574.8977 (0.020)
Step: 365812, Reward: 882.2574 [44.37], Avg: 575.5972 (0.020)
Step: 366812, Reward: 852.9333 [16.97], Avg: 576.2878 (0.020)
Step: 367812, Reward: 845.2442 [17.75], Avg: 576.9524 (0.020)
Step: 368812, Reward: 851.0022 [19.94], Avg: 577.6228 (0.020)
Step: 369812, Reward: 874.4286 [13.97], Avg: 578.3671 (0.020)
Step: 370812, Reward: 855.5966 [75.61], Avg: 578.8963 (0.020)
Step: 371812, Reward: 844.0826 [25.11], Avg: 579.5248 (0.020)
Step: 372812, Reward: 837.1679 [49.01], Avg: 580.0695 (0.020)
Step: 373812, Reward: 752.3258 [121.46], Avg: 580.2018 (0.020)
Step: 374812, Reward: 872.0467 [12.60], Avg: 580.9271 (0.020)
Step: 375812, Reward: 861.6458 [22.21], Avg: 581.5968 (0.020)
Step: 376812, Reward: 770.6869 [115.61], Avg: 581.7867 (0.020)
Step: 377812, Reward: 850.3050 [35.92], Avg: 582.3862 (0.020)
Step: 378812, Reward: 878.3796 [6.30], Avg: 583.1309 (0.020)
Step: 379812, Reward: 872.0574 [40.96], Avg: 583.7667 (0.020)
Step: 380812, Reward: 828.1470 [58.56], Avg: 584.2419 (0.020)
Step: 381812, Reward: 870.5925 [25.11], Avg: 584.9084 (0.020)
Step: 382812, Reward: 859.5757 [21.49], Avg: 585.5526 (0.020)
Step: 383812, Reward: 856.8977 [58.05], Avg: 586.0939 (0.020)
Step: 384812, Reward: 848.7482 [21.56], Avg: 586.7043 (0.020)
Step: 385812, Reward: 902.4383 [48.25], Avg: 587.3798 (0.020)
Step: 386812, Reward: 786.4769 [155.08], Avg: 587.4906 (0.020)
Step: 387812, Reward: 893.8310 [23.67], Avg: 588.2009 (0.020)
Step: 388812, Reward: 827.5900 [29.92], Avg: 588.7259 (0.020)
Step: 389812, Reward: 821.3937 [68.05], Avg: 589.1374 (0.020)
Step: 390812, Reward: 828.7624 [16.53], Avg: 589.6938 (0.020)
Step: 391812, Reward: 776.3407 [162.72], Avg: 589.7533 (0.020)
Step: 392812, Reward: 766.6968 [70.01], Avg: 590.0186 (0.020)
Step: 393812, Reward: 676.9876 [341.95], Avg: 589.3875 (0.020)
Step: 394812, Reward: 848.1573 [23.33], Avg: 589.9688 (0.020)
Step: 395812, Reward: 854.3382 [19.78], Avg: 590.5712 (0.020)
Step: 396812, Reward: 775.1420 [115.30], Avg: 590.7414 (0.020)
Step: 397812, Reward: 846.5256 [34.68], Avg: 591.2834 (0.020)
Step: 398812, Reward: 833.7827 [26.85], Avg: 591.8106 (0.020)
Step: 399812, Reward: 834.4884 [13.23], Avg: 592.3703 (0.020)
Step: 400812, Reward: 837.1467 [22.27], Avg: 592.9116 (0.020)
Step: 401812, Reward: 838.8886 [33.68], Avg: 593.4269 (0.020)
Step: 402812, Reward: 835.1152 [36.09], Avg: 593.9247 (0.020)
Step: 403812, Reward: 843.6426 [36.13], Avg: 594.4407 (0.020)
Step: 404812, Reward: 846.1132 [40.92], Avg: 594.9485 (0.020)
Step: 405812, Reward: 873.5578 [41.55], Avg: 595.5183 (0.020)
Step: 406812, Reward: 859.6099 [27.56], Avg: 596.0855 (0.020)
Step: 407812, Reward: 860.7097 [56.22], Avg: 596.5841 (0.020)
Step: 408812, Reward: 781.5683 [40.69], Avg: 596.9285 (0.020)
Step: 409812, Reward: 828.8621 [95.33], Avg: 597.2538 (0.020)
Step: 410812, Reward: 830.6583 [19.80], Avg: 597.7611 (0.020)
Step: 411812, Reward: 812.1236 [35.12], Avg: 598.1859 (0.020)
Step: 412812, Reward: 877.5030 [74.16], Avg: 598.6709 (0.020)
Step: 413812, Reward: 861.0151 [28.31], Avg: 599.2229 (0.020)
Step: 414812, Reward: 851.8229 [26.54], Avg: 599.7547 (0.020)
Step: 415812, Reward: 842.6954 [36.01], Avg: 600.2405 (0.020)
Step: 416812, Reward: 834.0278 [36.64], Avg: 600.7022 (0.020)
Step: 417812, Reward: 801.8712 [119.16], Avg: 600.8938 (0.020)
Step: 418812, Reward: 851.8638 [31.54], Avg: 601.4053 (0.020)
Step: 419812, Reward: 823.6665 [32.51], Avg: 601.8466 (0.020)
Step: 420812, Reward: 699.0817 [155.91], Avg: 601.7105 (0.020)
Step: 421812, Reward: 810.8774 [59.29], Avg: 602.0574 (0.020)
Step: 422812, Reward: 817.9499 [15.53], Avg: 602.5201 (0.020)
Step: 423812, Reward: 855.6986 [23.89], Avg: 603.0485 (0.020)
Step: 424812, Reward: 868.4488 [40.39], Avg: 603.5657 (0.020)
Step: 425812, Reward: 872.7604 [10.56], Avg: 604.1589 (0.020)
Step: 426812, Reward: 857.8616 [11.94], Avg: 604.7122 (0.020)
Step: 427812, Reward: 856.8698 [17.71], Avg: 605.2474 (0.020)
Step: 428630, Reward: 828.7049 [63.85], Avg: 605.6110 (0.020)
Step: 429630, Reward: 852.5501 [29.20], Avg: 606.1059 (0.020)
Step: 430630, Reward: 721.2312 [211.91], Avg: 605.8864 (0.020)
Step: 431630, Reward: 840.7130 [29.22], Avg: 606.3516 (0.020)
Step: 432630, Reward: 866.6737 [12.04], Avg: 606.9120 (0.020)
Step: 433630, Reward: 829.4328 [30.32], Avg: 607.3449 (0.020)
Step: 434630, Reward: 846.8230 [25.64], Avg: 607.8254 (0.020)
Step: 435630, Reward: 809.4575 [88.13], Avg: 608.0799 (0.020)
Step: 436630, Reward: 851.1870 [18.20], Avg: 608.5831 (0.020)
Step: 437630, Reward: 813.1943 [46.07], Avg: 608.9370 (0.020)
Step: 438630, Reward: 868.8529 [16.04], Avg: 609.4801 (0.020)
Step: 439630, Reward: 662.5194 [224.66], Avg: 609.0987 (0.020)
Step: 440630, Reward: 647.5946 [237.42], Avg: 608.6577 (0.020)
Step: 441403, Reward: 780.5086 [47.47], Avg: 608.9328 (0.020)
Step: 442403, Reward: 876.6685 [9.79], Avg: 609.5023 (0.020)
Step: 443403, Reward: 821.0561 [77.28], Avg: 609.7980 (0.020)
Step: 444403, Reward: 853.6237 [16.56], Avg: 610.2975 (0.020)
Step: 445403, Reward: 861.6617 [18.60], Avg: 610.8080 (0.020)
Step: 446403, Reward: 861.6999 [17.58], Avg: 611.3185 (0.020)
Step: 447403, Reward: 862.3867 [21.21], Avg: 611.8203 (0.020)
Step: 447972, Reward: 870.7094 [31.42], Avg: 612.3159 (0.020)
Step: 448972, Reward: 896.1520 [27.76], Avg: 612.8726 (0.020)
Step: 449972, Reward: 833.6966 [15.26], Avg: 613.3185 (0.020)
Step: 450972, Reward: 836.4455 [52.75], Avg: 613.6873 (0.020)
Step: 451972, Reward: 768.9503 [165.24], Avg: 613.6658 (0.020)
Step: 452972, Reward: 891.6176 [10.74], Avg: 614.2416 (0.020)
Step: 453972, Reward: 847.8565 [50.41], Avg: 614.6356 (0.020)
Step: 454972, Reward: 863.6329 [20.22], Avg: 615.1266 (0.020)
Step: 455972, Reward: 843.8198 [15.46], Avg: 615.5832 (0.020)
Step: 456972, Reward: 846.2648 [6.44], Avg: 616.0623 (0.020)
Step: 457972, Reward: 861.6928 [15.02], Avg: 616.5540 (0.020)
Step: 458972, Reward: 878.3543 [22.83], Avg: 617.0625 (0.020)
Step: 459972, Reward: 758.9567 [173.06], Avg: 616.9963 (0.020)
Step: 460972, Reward: 851.6061 [22.80], Avg: 617.4451 (0.020)
Step: 461972, Reward: 844.8414 [18.68], Avg: 617.8863 (0.020)
Step: 462972, Reward: 855.9384 [21.02], Avg: 618.3442 (0.020)
Step: 463688, Reward: 885.6053 [5.67], Avg: 618.8949 (0.020)
Step: 464688, Reward: 851.1350 [26.95], Avg: 619.3262 (0.020)
Step: 465423, Reward: 843.3026 [47.18], Avg: 619.6969 (0.020)
Step: 466423, Reward: 861.0269 [14.81], Avg: 620.1707 (0.020)
Step: 467423, Reward: 870.7888 [12.63], Avg: 620.6676 (0.020)
Step: 468423, Reward: 867.4008 [12.85], Avg: 621.1548 (0.020)
Step: 469423, Reward: 688.3197 [201.00], Avg: 620.8766 (0.020)
Step: 470423, Reward: 908.3540 [41.22], Avg: 621.3875 (0.020)
Step: 471423, Reward: 862.6593 [18.15], Avg: 621.8495 (0.020)
Step: 472423, Reward: 792.8234 [92.61], Avg: 622.0114 (0.020)
Step: 473423, Reward: 650.7732 [213.57], Avg: 621.6303 (0.020)
Step: 474423, Reward: 634.7694 [229.85], Avg: 621.1844 (0.020)
Step: 475423, Reward: 839.4906 [41.18], Avg: 621.5481 (0.020)
Step: 476423, Reward: 893.5524 [22.70], Avg: 622.0590 (0.020)
Step: 477423, Reward: 867.0127 [62.95], Avg: 622.4312 (0.020)
Step: 478423, Reward: 828.1276 [41.53], Avg: 622.7662 (0.020)
Step: 479423, Reward: 855.8805 [11.71], Avg: 623.2171 (0.020)
Step: 480423, Reward: 824.4002 [25.02], Avg: 623.5752 (0.020)
Step: 481423, Reward: 875.7410 [33.35], Avg: 624.0190 (0.020)
Step: 482423, Reward: 844.6358 [65.98], Avg: 624.3321 (0.020)
Step: 483423, Reward: 855.8709 [15.49], Avg: 624.7685 (0.020)
Step: 484423, Reward: 784.2706 [102.52], Avg: 624.8834 (0.020)
Step: 485423, Reward: 857.5641 [5.67], Avg: 625.3402 (0.020)
Step: 486423, Reward: 746.6093 [36.75], Avg: 625.5099 (0.020)
Step: 487423, Reward: 870.1649 [8.65], Avg: 625.9828 (0.020)
Step: 488423, Reward: 733.4257 [265.53], Avg: 625.6667 (0.020)
Step: 489423, Reward: 713.8340 [71.66], Avg: 625.6996 (0.020)
Step: 490423, Reward: 879.5480 [9.60], Avg: 626.1862 (0.020)
Step: 491423, Reward: 869.3448 [21.57], Avg: 626.6267 (0.020)
Step: 492423, Reward: 881.8184 [6.70], Avg: 627.1198 (0.020)
Step: 493423, Reward: 789.2867 [179.00], Avg: 627.0864 (0.020)
Step: 494423, Reward: 871.8827 [10.23], Avg: 627.5500 (0.020)
Step: 495423, Reward: 855.4317 [37.98], Avg: 627.9246 (0.020)
Step: 496423, Reward: 858.8617 [9.08], Avg: 628.3613 (0.020)
Step: 496962, Reward: 883.7202 [8.95], Avg: 628.8454 (0.020)
Step: 497962, Reward: 887.1402 [37.50], Avg: 629.2784 (0.020)
Step: 498962, Reward: 913.2347 [31.90], Avg: 629.7716 (0.020)
Step: 499694, Reward: 901.2537 [34.14], Avg: 630.2352 (0.020)

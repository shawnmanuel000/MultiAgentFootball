Model: <class 'models.ddpg.DDPGAgent'>, Dir: CartPole-v0
num_envs: 16,

import os
import math
import torch
import random
import numpy as np
from models.rand import RandomAgent, PrioritizedReplayBuffer, ReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, NUM_STEPS

EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.98             	# The rate at which eps decays from EPS_MAX to EPS_MIN
REPLAY_BATCH_SIZE = 32        	# How many experience tuples to sample from the buffer for each train step

class DDPGActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, sample=True):
		state = self.layer1(state).relu() 
		state = self.layer2(state).relu() 
		state = self.layer3(state).relu() 
		action_mu = self.action_mu(state)
		action_sig = self.action_sig(state).exp()
		epsilon = torch.randn_like(action_sig)
		action = action_mu + epsilon.mul(action_sig) if sample else action_mu
		return action.tanh()
	
class DDPGCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.net_state = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.net_action = torch.nn.Linear(*action_size, INPUT_LAYER)
		self.net_layer1 = torch.nn.Linear(2*INPUT_LAYER, CRITIC_HIDDEN)
		self.net_layer2 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.q_value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state, action):
		state = self.net_state(state).relu()
		net_action = self.net_action(action).relu()
		net_layer = torch.cat([state, net_action], dim=-1)
		net_layer = self.net_layer1(net_layer).relu()
		net_layer = self.net_layer2(net_layer).relu()
		q_value = self.q_value(net_layer)
		return q_value

class DDPGNetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None): 
		super().__init__(state_size, action_size, DDPGActor, DDPGCritic, lr=lr, gpu=gpu, load=load)

	def get_action(self, state, use_target=False, numpy=True, sample=True):
		with torch.no_grad():
			actor = self.actor_local if not use_target else self.actor_target
			return actor(state, sample).cpu().numpy() if numpy else actor(state, sample)

	def get_q_value(self, state, action, use_target=False, numpy=True):
		with torch.no_grad():
			critic = self.critic_local if not use_target else self.critic_target
			return critic(state, action).cpu().numpy() if numpy else critic(state, action)
	
	def optimize(self, states, actions, q_targets, importances=1):
		q_values = self.critic_local(states, actions)
		critic_error = q_values - q_targets.detach()
		critic_loss = importances.to(self.device) * critic_error.pow(2)
		self.step(self.critic_optimizer, critic_loss.mean())

		q_actions = self.critic_local(states, self.actor_local(states))
		actor_loss = -(q_actions - q_values.detach())
		self.step(self.actor_optimizer, actor_loss.mean())
		
		self.soft_copy(self.actor_local, self.actor_target)
		self.soft_copy(self.critic_local, self.critic_target)
		return critic_error.cpu().detach().numpy().squeeze(-1)
	
	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ddpg", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ddpg", dirname, name)

class DDPGAgent(PTACAgent):
	def __init__(self, state_size, action_size, decay=EPS_DECAY, lr=LEARN_RATE, update_freq=NUM_STEPS, gpu=True, load=None):
		super().__init__(state_size, action_size, DDPGNetwork, lr=lr, update_freq=update_freq, decay=decay, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True, e_greedy=False):
		eps = self.eps if eps is None else eps
		action_random = super().get_action(state, eps)
		if e_greedy and random.random() < eps: return action_random
		action_greedy = self.network.get_action(self.to_tensor(state), sample=sample)
		action = action_greedy if e_greedy else np.clip((1-eps)*action_greedy + eps*action_random, -1, 1)
		return action
		
	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, action, reward, done))
		if done[0]:#len(self.buffer) >= int(self.update_freq * (1 - self.eps + EPS_MIN)**0.5):
			states, actions, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()	
			next_state = self.to_tensor(next_state)
			next_action = self.network.get_action(next_state, use_target=True, numpy=False)
			values = self.network.get_q_value(states, actions, use_target=True, numpy=False)
			next_value = self.network.get_q_value(next_state, next_action, use_target=True, numpy=False)
			targets, _ = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values)
			states, actions, targets = [x.view(x.size(0)*x.size(1), *x.size()[2:]).cpu().numpy() for x in (states, actions, targets)]
			self.replay_buffer.extend(list(zip(states, actions, targets)), shuffle=True)	
		if len(self.replay_buffer) > 0:
			(states, actions, targets), indices, importances = self.replay_buffer.sample(REPLAY_BATCH_SIZE, dtype=self.to_tensor)
			errors = self.network.optimize(states, actions, targets, importances**(1-self.eps))
			self.replay_buffer.update_priorities(indices, errors)
			if done[0]: self.eps = max(self.eps * self.decay, EPS_MIN)

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0002           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 1000 				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import gym
import argparse
import numpy as np
# import gfootball.env as ggym
from collections import deque
from models.ppo import PPOAgent
from models.ddqn import DDQNAgent
from models.ddpg import DDPGAgent
from models.rand import RandomAgent
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, ImgStack, RawStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--model", type=str, default="ddqn", choices=["ddqn", "ddpg", "ppo", "rand"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--steps", type=int, default=100000, help="Number of steps to train the agent")
args = parser.parse_args()

gym_envs = ["CartPole-v0", "MountainCar-v0", "Acrobot-v1", "Pendulum-v0", "MountainCarContinuous-v0", "CarRacing-v0", "BipedalWalker-v2", "LunarLander-v2"]
gfb_envs = ["11_vs_11_stochastic", "academy_empty_goal_close"]
env_name = gym_envs[0]

def make_env(env_name=env_name, log=False):
	if env_name in gym_envs: return gym.make(env_name)
	reps = ["pixels", "pixels_gray", "extracted", "simple115"]
	env = ggym.create_environment(env_name=env_name, representation=reps[3], logdir='/football/logs/', render=False)
	env.spec = gym.envs.registration.EnvSpec(env_name + "-v0", max_episode_steps=env.unwrapped._config._scenario_cfg.game_duration)
	if log: print(f"State space: {env.observation_space.shape} \nAction space: {env.action_space.n}")
	return env

class PixelAgent(RandomAgent):
	def __init__(self, state_size, action_size, num_envs, agent, load="", gpu=True, train=True):
		super().__init__(state_size, action_size)
		statemodel = RawStack if len(state_size) == 1 else ImgStack
		self.stack = statemodel(state_size, num_envs, load=load, gpu=gpu)
		self.agent = agent(self.stack.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state = self.stack.get_state(state)
		env_action, action = self.agent.get_env_action(env, state, eps, sample)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.stack.get_state(next_state)
		self.agent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.stack.num_envs if num_envs is None else num_envs
		self.stack.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		if hasattr(self.agent, "network"): self.agent.network.save_model(dirname, name)

def run(model, steps=10000, ports=16, eval_at=1000):
	num_envs = len(ports) if type(ports) == list else min(ports, 64)
	logger = Logger(model, env_name, num_envs=num_envs)
	envs = EnvManager(make_env, ports) if type(ports) == list else EnsembleEnv(make_env, ports)
	agent = PixelAgent(envs.state_size, envs.action_size, num_envs, model)
	states = envs.reset()
	total_rewards = []
	for s in range(steps):
		agent.reset(num_envs)
		env_actions, actions, states = agent.get_env_action(envs.env, states)
		next_states, rewards, dones, _ = envs.step(env_actions)
		agent.train(states, actions, next_states, rewards, dones)
		states = next_states
		if dones[0]:
			rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(5)]
			test_reward = np.mean(rollouts) - np.std(rollouts)
			total_rewards.append(test_reward)
			agent.save_model(env_name, "checkpoint")
			if env_name in gfb_envs and total_rewards[-1] >= max(total_rewards): agent.save_model(env_name)
			logger.log(f"Step: {s}, Reward: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.agent.eps:.3f})")

if __name__ == "__main__":
	model = DDPGAgent if args.model == "ddpg" else PPOAgent if args.model == "ppo" else DDQNAgent if args.model == "ddqn" else RandomAgent
	if args.selfport is not None:
		EnvWorker(args.selfport, make_env).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, args.steps, args.workerports)
	print(f"Training finished")

Step: 7, Reward: 15.0000 [2.28], Avg: 12.7196 (0.980)
Step: 17, Reward: 15.8000 [5.49], Avg: 11.5139 (0.960)
Step: 31, Reward: 14.6000 [1.50], Avg: 12.0437 (0.941)
Step: 40, Reward: 11.8000 [3.66], Avg: 11.0690 (0.922)
Step: 50, Reward: 10.6000 [1.62], Avg: 10.6502 (0.904)
Step: 72, Reward: 12.4000 [2.33], Avg: 10.5531 (0.886)
Step: 80, Reward: 9.8000 [0.40], Avg: 10.3884 (0.868)
Step: 90, Reward: 9.4000 [0.80], Avg: 10.1649 (0.851)
Step: 98, Reward: 8.6000 [0.80], Avg: 9.9021 (0.834)
Step: 108, Reward: 9.0000 [0.63], Avg: 9.7486 (0.817)
Step: 123, Reward: 9.8000 [1.47], Avg: 9.6197 (0.801)
Step: 133, Reward: 9.4000 [0.80], Avg: 9.5347 (0.785)
Step: 141, Reward: 9.8000 [0.98], Avg: 9.4798 (0.769)
Step: 149, Reward: 9.4000 [0.49], Avg: 9.4391 (0.754)
Step: 158, Reward: 8.8000 [0.40], Avg: 9.3698 (0.739)
Step: 168, Reward: 9.2000 [0.40], Avg: 9.3342 (0.724)
Step: 191, Reward: 19.2000 [7.68], Avg: 9.4629 (0.709)
Step: 200, Reward: 15.4000 [3.93], Avg: 9.5744 (0.695)
Step: 225, Reward: 9.4000 [1.50], Avg: 9.4864 (0.681)
Step: 236, Reward: 9.6000 [0.49], Avg: 9.4676 (0.668)
Step: 245, Reward: 9.6000 [0.49], Avg: 9.4506 (0.654)
Step: 254, Reward: 9.4000 [0.49], Avg: 9.4260 (0.641)
Step: 264, Reward: 9.4000 [0.49], Avg: 9.4036 (0.628)
Step: 273, Reward: 9.6000 [1.02], Avg: 9.3693 (0.616)
Step: 283, Reward: 9.8000 [0.40], Avg: 9.3705 (0.603)
Step: 291, Reward: 8.8000 [0.75], Avg: 9.3198 (0.591)
Step: 300, Reward: 9.4000 [1.02], Avg: 9.2850 (0.580)
Step: 309, Reward: 9.0000 [0.63], Avg: 9.2522 (0.568)
Step: 318, Reward: 9.2000 [1.17], Avg: 9.2102 (0.557)
Step: 328, Reward: 9.2000 [0.75], Avg: 9.1849 (0.545)
Step: 338, Reward: 9.4000 [0.49], Avg: 9.1761 (0.535)
Step: 348, Reward: 9.2000 [0.75], Avg: 9.1534 (0.524)
Step: 358, Reward: 9.8000 [1.17], Avg: 9.1377 (0.513)
Step: 368, Reward: 9.6000 [0.80], Avg: 9.1277 (0.503)
Step: 377, Reward: 10.6000 [1.20], Avg: 9.1355 (0.493)
Step: 387, Reward: 9.0000 [0.63], Avg: 9.1142 (0.483)
Step: 401, Reward: 9.8000 [1.17], Avg: 9.1012 (0.474)
Step: 411, Reward: 9.6000 [0.80], Avg: 9.0933 (0.464)
Step: 420, Reward: 9.0000 [0.89], Avg: 9.0680 (0.455)
Step: 433, Reward: 9.4000 [0.80], Avg: 9.0563 (0.446)
Step: 443, Reward: 9.0000 [0.89], Avg: 9.0331 (0.437)
Step: 452, Reward: 9.2000 [0.75], Avg: 9.0192 (0.428)
Step: 462, Reward: 9.4000 [0.49], Avg: 9.0167 (0.419)
Step: 471, Reward: 10.0000 [1.10], Avg: 9.0141 (0.411)
Step: 483, Reward: 10.2000 [1.47], Avg: 9.0078 (0.403)
Step: 493, Reward: 11.2000 [1.60], Avg: 9.0207 (0.395)
Step: 503, Reward: 10.0000 [0.89], Avg: 9.0225 (0.387)
Step: 530, Reward: 9.6000 [1.02], Avg: 9.0133 (0.379)
Step: 546, Reward: 9.2000 [0.75], Avg: 9.0018 (0.372)
Step: 557, Reward: 9.8000 [0.40], Avg: 9.0098 (0.364)
Step: 568, Reward: 11.0000 [1.67], Avg: 9.0160 (0.357)
Step: 578, Reward: 10.4000 [1.50], Avg: 9.0138 (0.350)
Step: 636, Reward: 76.4000 [19.91], Avg: 9.9097 (0.343)
Step: 681, Reward: 87.0000 [21.19], Avg: 10.9448 (0.336)
Step: 756, Reward: 44.2000 [11.02], Avg: 11.3492 (0.329)
Step: 792, Reward: 44.0000 [5.33], Avg: 11.8370 (0.323)
Step: 975, Reward: 48.4000 [7.12], Avg: 12.3537 (0.316)
Step: 1018, Reward: 87.0000 [20.89], Avg: 13.2805 (0.310)
Step: 1090, Reward: 168.8000 [19.99], Avg: 15.5775 (0.304)
Step: 1193, Reward: 200.0000 [0.00], Avg: 18.6512 (0.298)
Step: 1282, Reward: 188.4000 [17.82], Avg: 21.1419 (0.292)
Step: 1446, Reward: 200.0000 [0.00], Avg: 24.0267 (0.286)
Step: 1489, Reward: 200.0000 [0.00], Avg: 26.8200 (0.280)
Step: 1584, Reward: 200.0000 [0.00], Avg: 29.5259 (0.274)
Step: 1690, Reward: 196.6000 [6.80], Avg: 31.9916 (0.269)
Step: 1890, Reward: 200.0000 [0.00], Avg: 34.5372 (0.264)
Step: 1909, Reward: 200.0000 [0.00], Avg: 37.0068 (0.258)
Step: 2047, Reward: 200.0000 [0.00], Avg: 39.4038 (0.253)
Step: 2128, Reward: 200.0000 [0.00], Avg: 41.7313 (0.248)
Step: 2172, Reward: 192.4000 [8.43], Avg: 43.7633 (0.243)
Step: 2283, Reward: 200.0000 [0.00], Avg: 45.9638 (0.238)
Step: 2326, Reward: 200.0000 [0.00], Avg: 48.1032 (0.233)
Step: 2447, Reward: 175.2000 [15.03], Avg: 49.6384 (0.229)
Step: 2647, Reward: 188.8000 [12.81], Avg: 51.3458 (0.224)
Step: 2797, Reward: 191.2000 [7.19], Avg: 53.1146 (0.220)
Step: 2932, Reward: 177.4000 [15.12], Avg: 54.5510 (0.215)
Step: 3076, Reward: 200.0000 [0.00], Avg: 56.4399 (0.211)
Step: 3269, Reward: 200.0000 [0.00], Avg: 58.2805 (0.207)
Step: 3418, Reward: 133.4000 [8.01], Avg: 59.1299 (0.203)
Step: 3464, Reward: 187.8000 [10.15], Avg: 60.6114 (0.199)
Step: 3664, Reward: 191.0000 [16.54], Avg: 62.0169 (0.195)
Step: 3714, Reward: 200.0000 [0.00], Avg: 63.6997 (0.191)
Step: 3744, Reward: 156.4000 [8.50], Avg: 64.7141 (0.187)
Step: 3801, Reward: 191.6000 [5.82], Avg: 66.1554 (0.183)
Step: 3870, Reward: 200.0000 [0.00], Avg: 67.7301 (0.180)
Step: 3990, Reward: 200.0000 [0.00], Avg: 69.2681 (0.176)
Step: 4119, Reward: 179.8000 [16.52], Avg: 70.3487 (0.172)
Step: 4140, Reward: 175.6000 [12.13], Avg: 71.4069 (0.169)
Step: 4317, Reward: 193.6000 [9.91], Avg: 72.6685 (0.166)
Step: 4457, Reward: 200.0000 [0.00], Avg: 74.0833 (0.162)
Step: 4618, Reward: 200.0000 [0.00], Avg: 75.4670 (0.159)
Step: 4736, Reward: 166.4000 [16.50], Avg: 76.2761 (0.156)
Step: 4763, Reward: 123.6000 [5.89], Avg: 76.7216 (0.153)
Step: 4845, Reward: 105.0000 [2.28], Avg: 76.9982 (0.150)
Step: 4976, Reward: 106.2000 [4.87], Avg: 77.2543 (0.147)
Step: 5176, Reward: 178.2000 [13.66], Avg: 78.1635 (0.144)
Step: 5219, Reward: 172.2000 [9.35], Avg: 79.0366 (0.141)
Step: 5410, Reward: 129.8000 [10.42], Avg: 79.4483 (0.138)
Step: 5598, Reward: 200.0000 [0.00], Avg: 80.6660 (0.135)
Step: 5727, Reward: 200.0000 [0.00], Avg: 81.8593 (0.133)
Step: 5758, Reward: 200.0000 [0.00], Avg: 83.0290 (0.130)
Step: 5868, Reward: 112.2000 [4.26], Avg: 83.2732 (0.127)
Step: 6068, Reward: 112.0000 [2.83], Avg: 83.5247 (0.125)
Step: 6176, Reward: 159.2000 [4.71], Avg: 84.2071 (0.122)
Step: 6350, Reward: 104.2000 [4.35], Avg: 84.3560 (0.120)
Step: 6414, Reward: 195.8000 [7.44], Avg: 85.3372 (0.117)
Step: 6461, Reward: 128.2000 [5.15], Avg: 85.6896 (0.115)
Step: 6553, Reward: 105.4000 [3.26], Avg: 85.8419 (0.113)
Step: 6753, Reward: 186.6000 [4.88], Avg: 86.7215 (0.111)
Step: 6799, Reward: 133.2000 [3.43], Avg: 87.1128 (0.108)
Step: 6882, Reward: 122.0000 [3.16], Avg: 87.3987 (0.106)
Step: 7022, Reward: 138.4000 [7.31], Avg: 87.7888 (0.104)
Step: 7122, Reward: 129.4000 [3.61], Avg: 88.1250 (0.102)
Step: 7156, Reward: 199.0000 [2.00], Avg: 89.0801 (0.100)
Step: 7295, Reward: 182.6000 [8.40], Avg: 89.8202 (0.098)
Step: 7448, Reward: 200.0000 [0.00], Avg: 90.7700 (0.096)
Step: 7502, Reward: 118.0000 [3.74], Avg: 90.9708 (0.094)
Step: 7591, Reward: 189.4000 [8.40], Avg: 91.7337 (0.092)
Step: 7615, Reward: 169.8000 [6.27], Avg: 92.3370 (0.090)
Step: 7773, Reward: 200.0000 [0.00], Avg: 93.2342 (0.089)
Step: 7865, Reward: 121.4000 [3.50], Avg: 93.4381 (0.087)
Step: 7903, Reward: 146.8000 [2.79], Avg: 93.8526 (0.085)
Step: 8103, Reward: 200.0000 [0.00], Avg: 94.7156 (0.083)
Step: 8303, Reward: 200.0000 [0.00], Avg: 95.5647 (0.082)
Step: 8503, Reward: 195.4000 [9.20], Avg: 96.2898 (0.080)
Step: 8703, Reward: 200.0000 [0.00], Avg: 97.1129 (0.078)
Step: 8903, Reward: 200.0000 [0.00], Avg: 97.9230 (0.077)
Step: 8988, Reward: 166.6000 [16.95], Avg: 98.3271 (0.075)
Step: 9001, Reward: 197.4000 [5.20], Avg: 99.0548 (0.074)
Step: 9166, Reward: 200.0000 [0.00], Avg: 99.8313 (0.072)
Step: 9293, Reward: 200.0000 [0.00], Avg: 100.5959 (0.071)
Step: 9397, Reward: 200.0000 [0.00], Avg: 101.3490 (0.069)
Step: 9515, Reward: 148.0000 [4.69], Avg: 101.6645 (0.068)
Step: 9653, Reward: 200.0000 [0.00], Avg: 102.3983 (0.067)
Step: 9794, Reward: 200.0000 [0.00], Avg: 103.1213 (0.065)
Step: 9994, Reward: 150.0000 [6.99], Avg: 103.4146 (0.064)
Step: 10122, Reward: 142.6000 [3.38], Avg: 103.6760 (0.063)
Step: 10246, Reward: 200.0000 [0.00], Avg: 104.3740 (0.062)
Step: 10285, Reward: 200.0000 [0.00], Avg: 105.0619 (0.060)
Step: 10485, Reward: 200.0000 [0.00], Avg: 105.7401 (0.059)
Step: 10614, Reward: 200.0000 [0.00], Avg: 106.4086 (0.058)
Step: 10814, Reward: 200.0000 [0.00], Avg: 107.0677 (0.057)
Step: 10905, Reward: 200.0000 [0.00], Avg: 107.7175 (0.056)
Step: 11035, Reward: 200.0000 [0.00], Avg: 108.3584 (0.055)
Step: 11144, Reward: 200.0000 [0.00], Avg: 108.9904 (0.053)
Step: 11247, Reward: 153.0000 [25.51], Avg: 109.1171 (0.052)
Step: 11447, Reward: 200.0000 [0.00], Avg: 109.7354 (0.051)
Step: 11647, Reward: 200.0000 [0.00], Avg: 110.3452 (0.050)
Step: 11732, Reward: 200.0000 [0.00], Avg: 110.9470 (0.049)
Step: 11832, Reward: 200.0000 [0.00], Avg: 111.5406 (0.048)
Step: 11846, Reward: 200.0000 [0.00], Avg: 112.1265 (0.047)
Step: 11928, Reward: 200.0000 [0.00], Avg: 112.7046 (0.046)
Step: 11987, Reward: 200.0000 [0.00], Avg: 113.2751 (0.045)
Step: 12045, Reward: 200.0000 [0.00], Avg: 113.8383 (0.045)
Step: 12181, Reward: 200.0000 [0.00], Avg: 114.3942 (0.044)
Step: 12319, Reward: 170.2000 [26.73], Avg: 114.5805 (0.043)
Step: 12387, Reward: 137.6000 [13.09], Avg: 114.6438 (0.042)
Step: 12436, Reward: 161.2000 [23.31], Avg: 114.7909 (0.041)
Step: 12518, Reward: 190.4000 [13.06], Avg: 115.1843 (0.040)
Step: 12691, Reward: 200.0000 [0.00], Avg: 115.7144 (0.039)
Step: 12772, Reward: 130.0000 [55.58], Avg: 115.4579 (0.039)
Step: 12860, Reward: 195.4000 [9.20], Avg: 115.8945 (0.038)
Step: 13060, Reward: 200.0000 [0.00], Avg: 116.4105 (0.037)
Step: 13101, Reward: 195.2000 [9.60], Avg: 116.8324 (0.036)
Step: 13149, Reward: 169.8000 [42.63], Avg: 116.8951 (0.036)
Step: 13185, Reward: 180.2000 [23.75], Avg: 117.1334 (0.035)
Step: 13329, Reward: 155.4000 [20.90], Avg: 117.2374 (0.034)
Step: 13514, Reward: 200.0000 [0.00], Avg: 117.7300 (0.034)
Step: 13714, Reward: 183.8000 [24.79], Avg: 117.9743 (0.033)
Step: 13888, Reward: 138.2000 [20.20], Avg: 117.9744 (0.032)
Step: 14020, Reward: 200.0000 [0.00], Avg: 118.4541 (0.032)
Step: 14154, Reward: 175.8000 [29.65], Avg: 118.6151 (0.031)
Step: 14226, Reward: 195.4000 [8.71], Avg: 119.0086 (0.030)
Step: 14318, Reward: 180.6000 [22.62], Avg: 119.2325 (0.030)
Step: 14366, Reward: 200.0000 [0.00], Avg: 119.6941 (0.029)
Step: 14538, Reward: 200.0000 [0.00], Avg: 120.1503 (0.029)
Step: 14738, Reward: 200.0000 [0.00], Avg: 120.6015 (0.028)
Step: 14810, Reward: 177.4000 [16.88], Avg: 120.8257 (0.027)
Step: 14873, Reward: 199.8000 [0.40], Avg: 121.2647 (0.027)
Step: 15023, Reward: 165.2000 [22.69], Avg: 121.3827 (0.026)
Step: 15183, Reward: 200.0000 [0.00], Avg: 121.8170 (0.026)
Step: 15383, Reward: 200.0000 [0.00], Avg: 122.2466 (0.025)
Step: 15489, Reward: 200.0000 [0.00], Avg: 122.6715 (0.025)
Step: 15610, Reward: 200.0000 [0.00], Avg: 123.0918 (0.024)
Step: 15648, Reward: 200.0000 [0.00], Avg: 123.5075 (0.024)
Step: 15848, Reward: 200.0000 [0.00], Avg: 123.9187 (0.023)
Step: 16048, Reward: 200.0000 [0.00], Avg: 124.3256 (0.023)
Step: 16206, Reward: 200.0000 [0.00], Avg: 124.7281 (0.022)
Step: 16255, Reward: 200.0000 [0.00], Avg: 125.1264 (0.022)
Step: 16362, Reward: 187.8000 [24.40], Avg: 125.3278 (0.022)
Step: 16562, Reward: 179.0000 [26.15], Avg: 125.4719 (0.021)
Step: 16588, Reward: 183.2000 [25.57], Avg: 125.6394 (0.021)
Step: 16731, Reward: 200.0000 [0.00], Avg: 126.0247 (0.020)
Step: 16851, Reward: 200.0000 [0.00], Avg: 126.4060 (0.020)
Step: 16991, Reward: 200.0000 [0.00], Avg: 126.7834 (0.020)
Step: 17109, Reward: 174.8000 [27.76], Avg: 126.8868 (0.020)
Step: 17229, Reward: 200.0000 [0.00], Avg: 127.2579 (0.020)
Step: 17363, Reward: 181.4000 [17.34], Avg: 127.4438 (0.020)
Step: 17464, Reward: 200.0000 [0.00], Avg: 127.8084 (0.020)
Step: 17539, Reward: 200.0000 [0.00], Avg: 128.1693 (0.020)
Step: 17677, Reward: 195.0000 [10.00], Avg: 128.4521 (0.020)
Step: 17714, Reward: 185.8000 [28.40], Avg: 128.5954 (0.020)
Step: 17816, Reward: 177.0000 [21.52], Avg: 128.7278 (0.020)
Step: 17904, Reward: 190.6000 [18.80], Avg: 128.9389 (0.020)
Step: 18066, Reward: 194.2000 [11.60], Avg: 129.2007 (0.020)
Step: 18164, Reward: 179.2000 [25.51], Avg: 129.3196 (0.020)
Step: 18300, Reward: 200.0000 [0.00], Avg: 129.6610 (0.020)
Step: 18500, Reward: 200.0000 [0.00], Avg: 129.9992 (0.020)
Step: 18620, Reward: 200.0000 [0.00], Avg: 130.3341 (0.020)
Step: 18749, Reward: 185.0000 [17.84], Avg: 130.5095 (0.020)
Step: 18910, Reward: 200.0000 [0.00], Avg: 130.8388 (0.020)
Step: 19021, Reward: 192.6000 [14.80], Avg: 131.0603 (0.020)
Step: 19140, Reward: 200.0000 [0.00], Avg: 131.3840 (0.020)
Step: 19340, Reward: 151.8000 [24.56], Avg: 131.3647 (0.020)
Step: 19524, Reward: 172.8000 [23.01], Avg: 131.4504 (0.020)
Step: 19724, Reward: 200.0000 [0.00], Avg: 131.7677 (0.020)
Step: 19785, Reward: 200.0000 [0.00], Avg: 132.0822 (0.020)
Step: 19985, Reward: 200.0000 [0.00], Avg: 132.3937 (0.020)
Step: 20083, Reward: 192.6000 [9.20], Avg: 132.6266 (0.020)
Step: 20131, Reward: 171.2000 [9.93], Avg: 132.7568 (0.020)
Step: 20331, Reward: 199.6000 [0.80], Avg: 133.0557 (0.020)
Step: 20429, Reward: 186.0000 [18.28], Avg: 133.2118 (0.020)
Step: 20521, Reward: 200.0000 [0.00], Avg: 133.5113 (0.020)
Step: 20557, Reward: 198.6000 [2.80], Avg: 133.7894 (0.020)
Step: 20667, Reward: 200.0000 [0.00], Avg: 134.0837 (0.020)
Step: 20867, Reward: 200.0000 [0.00], Avg: 134.3753 (0.020)
Step: 20988, Reward: 196.2000 [7.60], Avg: 134.6142 (0.020)
Step: 21188, Reward: 200.0000 [0.00], Avg: 134.9010 (0.020)
Step: 21370, Reward: 200.0000 [0.00], Avg: 135.1853 (0.020)
Step: 21491, Reward: 196.8000 [6.40], Avg: 135.4253 (0.020)
Step: 21612, Reward: 183.6000 [26.78], Avg: 135.5180 (0.020)
Step: 21812, Reward: 196.2000 [7.60], Avg: 135.7468 (0.020)
Step: 21961, Reward: 200.0000 [0.00], Avg: 136.0225 (0.020)
Step: 22135, Reward: 200.0000 [0.00], Avg: 136.2959 (0.020)
Step: 22335, Reward: 200.0000 [0.00], Avg: 136.5670 (0.020)
Step: 22520, Reward: 200.0000 [0.00], Avg: 136.8358 (0.020)
Step: 22720, Reward: 200.0000 [0.00], Avg: 137.1023 (0.020)
Step: 22920, Reward: 200.0000 [0.00], Avg: 137.3666 (0.020)
Step: 23120, Reward: 200.0000 [0.00], Avg: 137.6287 (0.020)
Step: 23266, Reward: 200.0000 [0.00], Avg: 137.8885 (0.020)
Step: 23466, Reward: 200.0000 [0.00], Avg: 138.1463 (0.020)
Step: 23666, Reward: 200.0000 [0.00], Avg: 138.4019 (0.020)
Step: 23866, Reward: 200.0000 [0.00], Avg: 138.6553 (0.020)
Step: 24066, Reward: 200.0000 [0.00], Avg: 138.9068 (0.020)
Step: 24266, Reward: 200.0000 [0.00], Avg: 139.1561 (0.020)
Step: 24466, Reward: 200.0000 [0.00], Avg: 139.4035 (0.020)
Step: 24666, Reward: 200.0000 [0.00], Avg: 139.6488 (0.020)
Step: 24866, Reward: 200.0000 [0.00], Avg: 139.8921 (0.020)
Step: 25066, Reward: 200.0000 [0.00], Avg: 140.1335 (0.020)
Step: 25266, Reward: 200.0000 [0.00], Avg: 140.3730 (0.020)
Step: 25466, Reward: 200.0000 [0.00], Avg: 140.6106 (0.020)
Step: 25666, Reward: 200.0000 [0.00], Avg: 140.8462 (0.020)
Step: 25840, Reward: 200.0000 [0.00], Avg: 141.0800 (0.020)
Step: 26040, Reward: 200.0000 [0.00], Avg: 141.3120 (0.020)
Step: 26240, Reward: 200.0000 [0.00], Avg: 141.5422 (0.020)
Step: 26440, Reward: 200.0000 [0.00], Avg: 141.7705 (0.020)
Step: 26640, Reward: 200.0000 [0.00], Avg: 141.9971 (0.020)
Step: 26840, Reward: 200.0000 [0.00], Avg: 142.2219 (0.020)
Step: 27040, Reward: 200.0000 [0.00], Avg: 142.4450 (0.020)
Step: 27240, Reward: 200.0000 [0.00], Avg: 142.6663 (0.020)
Step: 27440, Reward: 200.0000 [0.00], Avg: 142.8860 (0.020)
Step: 27640, Reward: 200.0000 [0.00], Avg: 143.1040 (0.020)
Step: 27840, Reward: 200.0000 [0.00], Avg: 143.3203 (0.020)
Step: 28040, Reward: 200.0000 [0.00], Avg: 143.5350 (0.020)
Step: 28229, Reward: 200.0000 [0.00], Avg: 143.7481 (0.020)
Step: 28429, Reward: 200.0000 [0.00], Avg: 143.9596 (0.020)
Step: 28629, Reward: 200.0000 [0.00], Avg: 144.1695 (0.020)
Step: 28829, Reward: 200.0000 [0.00], Avg: 144.3778 (0.020)
Step: 29029, Reward: 200.0000 [0.00], Avg: 144.5846 (0.020)
Step: 29229, Reward: 200.0000 [0.00], Avg: 144.7898 (0.020)
Step: 29429, Reward: 200.0000 [0.00], Avg: 144.9935 (0.020)
Step: 29629, Reward: 200.0000 [0.00], Avg: 145.1958 (0.020)
Step: 29829, Reward: 200.0000 [0.00], Avg: 145.3965 (0.020)
Step: 30029, Reward: 200.0000 [0.00], Avg: 145.5958 (0.020)
Step: 30229, Reward: 200.0000 [0.00], Avg: 145.7936 (0.020)
Step: 30429, Reward: 200.0000 [0.00], Avg: 145.9900 (0.020)
Step: 30582, Reward: 200.0000 [0.00], Avg: 146.1850 (0.020)
Step: 30782, Reward: 200.0000 [0.00], Avg: 146.3786 (0.020)
Step: 30982, Reward: 200.0000 [0.00], Avg: 146.5708 (0.020)
Step: 31182, Reward: 200.0000 [0.00], Avg: 146.7616 (0.020)
Step: 31382, Reward: 197.4000 [3.20], Avg: 146.9304 (0.020)
Step: 31544, Reward: 200.0000 [0.00], Avg: 147.1186 (0.020)
Step: 31744, Reward: 151.4000 [4.84], Avg: 147.1166 (0.020)
Step: 31944, Reward: 170.4000 [6.37], Avg: 147.1762 (0.020)
Step: 32080, Reward: 167.0000 [6.60], Avg: 147.2226 (0.020)
Step: 32231, Reward: 197.6000 [4.80], Avg: 147.3819 (0.020)
Step: 32431, Reward: 200.0000 [0.00], Avg: 147.5653 (0.020)
Step: 32558, Reward: 200.0000 [0.00], Avg: 147.7473 (0.020)
Step: 32758, Reward: 200.0000 [0.00], Avg: 147.9281 (0.020)
Step: 32958, Reward: 200.0000 [0.00], Avg: 148.1077 (0.020)
Step: 33158, Reward: 200.0000 [0.00], Avg: 148.2860 (0.020)
Step: 33288, Reward: 178.8000 [42.40], Avg: 148.2453 (0.020)
Step: 33465, Reward: 127.2000 [70.17], Avg: 147.9340 (0.020)
Step: 33665, Reward: 183.6000 [32.80], Avg: 147.9437 (0.020)
Step: 33727, Reward: 180.4000 [39.20], Avg: 147.9209 (0.020)
Step: 33927, Reward: 163.4000 [45.63], Avg: 147.8190 (0.020)
Step: 34010, Reward: 200.0000 [0.00], Avg: 147.9947 (0.020)
Step: 34049, Reward: 194.6000 [10.80], Avg: 148.1149 (0.020)
Step: 34186, Reward: 200.0000 [0.00], Avg: 148.2884 (0.020)
Step: 34386, Reward: 200.0000 [0.00], Avg: 148.4608 (0.020)
Step: 34464, Reward: 200.0000 [0.00], Avg: 148.6320 (0.020)
Step: 34664, Reward: 200.0000 [0.00], Avg: 148.8021 (0.020)
Step: 34862, Reward: 187.4000 [25.20], Avg: 148.8463 (0.020)
Step: 34966, Reward: 200.0000 [0.00], Avg: 149.0146 (0.020)
Step: 35166, Reward: 200.0000 [0.00], Avg: 149.1817 (0.020)
Step: 35366, Reward: 200.0000 [0.00], Avg: 149.3478 (0.020)
Step: 35403, Reward: 200.0000 [0.00], Avg: 149.5128 (0.020)
Step: 35535, Reward: 168.0000 [64.00], Avg: 149.3650 (0.020)
Step: 35596, Reward: 200.0000 [0.00], Avg: 149.5289 (0.020)
Step: 35691, Reward: 200.0000 [0.00], Avg: 149.6917 (0.020)
Step: 35760, Reward: 200.0000 [0.00], Avg: 149.8535 (0.020)
Step: 35824, Reward: 170.6000 [58.80], Avg: 149.7315 (0.020)
Step: 35941, Reward: 175.0000 [28.59], Avg: 149.7209 (0.020)
Step: 36048, Reward: 186.6000 [16.92], Avg: 149.7844 (0.020)
Step: 36078, Reward: 200.0000 [0.00], Avg: 149.9439 (0.020)
Step: 36163, Reward: 152.0000 [22.79], Avg: 149.8782 (0.020)
Step: 36281, Reward: 200.0000 [0.00], Avg: 150.0363 (0.020)
Step: 36481, Reward: 200.0000 [0.00], Avg: 150.1935 (0.020)
Step: 36681, Reward: 200.0000 [0.00], Avg: 150.3496 (0.020)
Step: 36706, Reward: 200.0000 [0.00], Avg: 150.5047 (0.020)
Step: 36901, Reward: 200.0000 [0.00], Avg: 150.6589 (0.020)
Step: 37101, Reward: 200.0000 [0.00], Avg: 150.8122 (0.020)
Step: 37301, Reward: 200.0000 [0.00], Avg: 150.9645 (0.020)
Step: 37501, Reward: 200.0000 [0.00], Avg: 151.1158 (0.020)
Step: 37656, Reward: 200.0000 [0.00], Avg: 151.2662 (0.020)
Step: 37720, Reward: 197.2000 [5.60], Avg: 151.3899 (0.020)
Step: 37920, Reward: 200.0000 [0.00], Avg: 151.5386 (0.020)
Step: 38093, Reward: 200.0000 [0.00], Avg: 151.6863 (0.020)
Step: 38293, Reward: 200.0000 [0.00], Avg: 151.8332 (0.020)
Step: 38453, Reward: 200.0000 [0.00], Avg: 151.9791 (0.020)
Step: 38646, Reward: 200.0000 [0.00], Avg: 152.1242 (0.020)
Step: 38846, Reward: 200.0000 [0.00], Avg: 152.2684 (0.020)
Step: 39031, Reward: 200.0000 [0.00], Avg: 152.4118 (0.020)
Step: 39231, Reward: 200.0000 [0.00], Avg: 152.5542 (0.020)
Step: 39431, Reward: 200.0000 [0.00], Avg: 152.6959 (0.020)
Step: 39586, Reward: 195.4000 [9.20], Avg: 152.7956 (0.020)
Step: 39786, Reward: 200.0000 [0.00], Avg: 152.9357 (0.020)
Step: 39986, Reward: 200.0000 [0.00], Avg: 153.0749 (0.020)
Step: 40186, Reward: 200.0000 [0.00], Avg: 153.2133 (0.020)
Step: 40386, Reward: 200.0000 [0.00], Avg: 153.3509 (0.020)
Step: 40586, Reward: 194.4000 [8.16], Avg: 153.4474 (0.020)
Step: 40786, Reward: 200.0000 [0.00], Avg: 153.5835 (0.020)
Step: 40986, Reward: 200.0000 [0.00], Avg: 153.7188 (0.020)
Step: 41186, Reward: 200.0000 [0.00], Avg: 153.8534 (0.020)
Step: 41386, Reward: 200.0000 [0.00], Avg: 153.9871 (0.020)
Step: 41586, Reward: 200.0000 [0.00], Avg: 154.1201 (0.020)
Step: 41786, Reward: 200.0000 [0.00], Avg: 154.2523 (0.020)
Step: 41986, Reward: 200.0000 [0.00], Avg: 154.3838 (0.020)
Step: 42186, Reward: 200.0000 [0.00], Avg: 154.5145 (0.020)
Step: 42386, Reward: 200.0000 [0.00], Avg: 154.6444 (0.020)
Step: 42586, Reward: 200.0000 [0.00], Avg: 154.7737 (0.020)
Step: 42786, Reward: 200.0000 [0.00], Avg: 154.9021 (0.020)
Step: 42986, Reward: 200.0000 [0.00], Avg: 155.0299 (0.020)
Step: 43186, Reward: 200.0000 [0.00], Avg: 155.1569 (0.020)
Step: 43386, Reward: 200.0000 [0.00], Avg: 155.2833 (0.020)
Step: 43577, Reward: 200.0000 [0.00], Avg: 155.4089 (0.020)
Step: 43775, Reward: 200.0000 [0.00], Avg: 155.5338 (0.020)
Step: 43975, Reward: 200.0000 [0.00], Avg: 155.6580 (0.020)
Step: 44175, Reward: 200.0000 [0.00], Avg: 155.7815 (0.020)
Step: 44375, Reward: 200.0000 [0.00], Avg: 155.9043 (0.020)
Step: 44575, Reward: 200.0000 [0.00], Avg: 156.0265 (0.020)
Step: 44775, Reward: 200.0000 [0.00], Avg: 156.1479 (0.020)
Step: 44975, Reward: 200.0000 [0.00], Avg: 156.2687 (0.020)
Step: 45175, Reward: 200.0000 [0.00], Avg: 156.3889 (0.020)
Step: 45375, Reward: 182.6000 [3.72], Avg: 156.4505 (0.020)
Step: 45516, Reward: 188.6000 [22.80], Avg: 156.4761 (0.020)
Step: 45688, Reward: 161.0000 [1.90], Avg: 156.4832 (0.020)
Step: 45818, Reward: 200.0000 [0.00], Avg: 156.6015 (0.020)
Step: 45976, Reward: 192.6000 [6.56], Avg: 156.6812 (0.020)
Step: 46115, Reward: 167.4000 [5.78], Avg: 156.6946 (0.020)
Step: 46308, Reward: 168.8000 [4.75], Avg: 156.7144 (0.020)
Step: 46461, Reward: 198.8000 [2.40], Avg: 156.8211 (0.020)
Step: 46661, Reward: 167.8000 [3.12], Avg: 156.8421 (0.020)
Step: 46830, Reward: 200.0000 [0.00], Avg: 156.9575 (0.020)
Step: 47030, Reward: 200.0000 [0.00], Avg: 157.0723 (0.020)
Step: 47230, Reward: 200.0000 [0.00], Avg: 157.1865 (0.020)
Step: 47430, Reward: 200.0000 [0.00], Avg: 157.3001 (0.020)
Step: 47630, Reward: 200.0000 [0.00], Avg: 157.4130 (0.020)
Step: 47830, Reward: 200.0000 [0.00], Avg: 157.5254 (0.020)
Step: 48030, Reward: 180.2000 [8.23], Avg: 157.5634 (0.020)
Step: 48199, Reward: 200.0000 [0.00], Avg: 157.6748 (0.020)
Step: 48399, Reward: 200.0000 [0.00], Avg: 157.7856 (0.020)
Step: 48599, Reward: 174.6000 [3.72], Avg: 157.8198 (0.020)
Step: 48799, Reward: 200.0000 [0.00], Avg: 157.9296 (0.020)
Step: 48999, Reward: 200.0000 [0.00], Avg: 158.0389 (0.020)
Step: 49199, Reward: 200.0000 [0.00], Avg: 158.1476 (0.020)
Step: 49364, Reward: 200.0000 [0.00], Avg: 158.2557 (0.020)
Step: 49564, Reward: 200.0000 [0.00], Avg: 158.3633 (0.020)
Step: 49764, Reward: 200.0000 [0.00], Avg: 158.4704 (0.020)
Step: 49964, Reward: 200.0000 [0.00], Avg: 158.5768 (0.020)
Step: 50164, Reward: 200.0000 [0.00], Avg: 158.6828 (0.020)
Step: 50359, Reward: 200.0000 [0.00], Avg: 158.7882 (0.020)
Step: 50559, Reward: 200.0000 [0.00], Avg: 158.8931 (0.020)
Step: 50759, Reward: 200.0000 [0.00], Avg: 158.9974 (0.020)
Step: 50959, Reward: 200.0000 [0.00], Avg: 159.1012 (0.020)
Step: 51159, Reward: 200.0000 [0.00], Avg: 159.2045 (0.020)
Step: 51359, Reward: 200.0000 [0.00], Avg: 159.3072 (0.020)
Step: 51559, Reward: 195.2000 [6.01], Avg: 159.3823 (0.020)
Step: 51759, Reward: 200.0000 [0.00], Avg: 159.4841 (0.020)
Step: 51959, Reward: 200.0000 [0.00], Avg: 159.5854 (0.020)
Step: 52159, Reward: 194.2000 [4.92], Avg: 159.6595 (0.020)
Step: 52359, Reward: 200.0000 [0.00], Avg: 159.7598 (0.020)
Step: 52559, Reward: 200.0000 [0.00], Avg: 159.8597 (0.020)
Step: 52759, Reward: 200.0000 [0.00], Avg: 159.9590 (0.020)
Step: 52959, Reward: 200.0000 [0.00], Avg: 160.0579 (0.020)
Step: 53159, Reward: 200.0000 [0.00], Avg: 160.1563 (0.020)
Step: 53335, Reward: 200.0000 [0.00], Avg: 160.2542 (0.020)
Step: 53535, Reward: 200.0000 [0.00], Avg: 160.3516 (0.020)
Step: 53735, Reward: 200.0000 [0.00], Avg: 160.4485 (0.020)
Step: 53935, Reward: 200.0000 [0.00], Avg: 160.5450 (0.020)
Step: 54135, Reward: 200.0000 [0.00], Avg: 160.6410 (0.020)
Step: 54335, Reward: 199.4000 [1.20], Avg: 160.7321 (0.020)
Step: 54535, Reward: 200.0000 [0.00], Avg: 160.8272 (0.020)
Step: 54735, Reward: 200.0000 [0.00], Avg: 160.9218 (0.020)
Step: 54935, Reward: 200.0000 [0.00], Avg: 161.0160 (0.020)
Step: 55135, Reward: 200.0000 [0.00], Avg: 161.1097 (0.020)
Step: 55335, Reward: 200.0000 [0.00], Avg: 161.2030 (0.020)
Step: 55535, Reward: 200.0000 [0.00], Avg: 161.2958 (0.020)
Step: 55735, Reward: 200.0000 [0.00], Avg: 161.3882 (0.020)
Step: 55935, Reward: 200.0000 [0.00], Avg: 161.4801 (0.020)
Step: 56129, Reward: 200.0000 [0.00], Avg: 161.5716 (0.020)
Step: 56329, Reward: 200.0000 [0.00], Avg: 161.6627 (0.020)
Step: 56529, Reward: 200.0000 [0.00], Avg: 161.7533 (0.020)
Step: 56729, Reward: 200.0000 [0.00], Avg: 161.8435 (0.020)
Step: 56929, Reward: 200.0000 [0.00], Avg: 161.9333 (0.020)
Step: 57129, Reward: 200.0000 [0.00], Avg: 162.0226 (0.020)
Step: 57329, Reward: 200.0000 [0.00], Avg: 162.1116 (0.020)
Step: 57527, Reward: 200.0000 [0.00], Avg: 162.2001 (0.020)
Step: 57727, Reward: 200.0000 [0.00], Avg: 162.2882 (0.020)
Step: 57927, Reward: 200.0000 [0.00], Avg: 162.3759 (0.020)
Step: 58127, Reward: 200.0000 [0.00], Avg: 162.4632 (0.020)
Step: 58327, Reward: 200.0000 [0.00], Avg: 162.5501 (0.020)
Step: 58527, Reward: 200.0000 [0.00], Avg: 162.6366 (0.020)
Step: 58727, Reward: 200.0000 [0.00], Avg: 162.7227 (0.020)
Step: 58927, Reward: 200.0000 [0.00], Avg: 162.8084 (0.020)
Step: 59127, Reward: 200.0000 [0.00], Avg: 162.8937 (0.020)
Step: 59327, Reward: 198.8000 [2.40], Avg: 162.9703 (0.020)
Step: 59527, Reward: 200.0000 [0.00], Avg: 163.0549 (0.020)
Step: 59727, Reward: 200.0000 [0.00], Avg: 163.1390 (0.020)
Step: 59927, Reward: 200.0000 [0.00], Avg: 163.2228 (0.020)
Step: 60127, Reward: 200.0000 [0.00], Avg: 163.3062 (0.020)
Step: 60327, Reward: 200.0000 [0.00], Avg: 163.3892 (0.020)
Step: 60527, Reward: 200.0000 [0.00], Avg: 163.4719 (0.020)
Step: 60727, Reward: 200.0000 [0.00], Avg: 163.5541 (0.020)
Step: 60927, Reward: 200.0000 [0.00], Avg: 163.6360 (0.020)
Step: 61127, Reward: 200.0000 [0.00], Avg: 163.7176 (0.020)
Step: 61327, Reward: 200.0000 [0.00], Avg: 163.7987 (0.020)
Step: 61527, Reward: 200.0000 [0.00], Avg: 163.8796 (0.020)
Step: 61727, Reward: 200.0000 [0.00], Avg: 163.9600 (0.020)
Step: 61927, Reward: 200.0000 [0.00], Avg: 164.0401 (0.020)
Step: 62114, Reward: 188.4000 [6.77], Avg: 164.0791 (0.020)
Step: 62314, Reward: 200.0000 [0.00], Avg: 164.1586 (0.020)
Step: 62514, Reward: 199.8000 [0.40], Avg: 164.2364 (0.020)
Step: 62681, Reward: 191.8000 [10.05], Avg: 164.2749 (0.020)
Step: 62881, Reward: 200.0000 [0.00], Avg: 164.3535 (0.020)
Step: 63081, Reward: 200.0000 [0.00], Avg: 164.4316 (0.020)
Step: 63281, Reward: 200.0000 [0.00], Avg: 164.5095 (0.020)
Step: 63481, Reward: 200.0000 [0.00], Avg: 164.5869 (0.020)
Step: 63681, Reward: 200.0000 [0.00], Avg: 164.6641 (0.020)
Step: 63881, Reward: 200.0000 [0.00], Avg: 164.7409 (0.020)
Step: 64081, Reward: 200.0000 [0.00], Avg: 164.8174 (0.020)
Step: 64281, Reward: 200.0000 [0.00], Avg: 164.8936 (0.020)
Step: 64481, Reward: 200.0000 [0.00], Avg: 164.9694 (0.020)
Step: 64681, Reward: 200.0000 [0.00], Avg: 165.0449 (0.020)
Step: 64881, Reward: 200.0000 [0.00], Avg: 165.1200 (0.020)
Step: 65081, Reward: 200.0000 [0.00], Avg: 165.1949 (0.020)
Step: 65281, Reward: 200.0000 [0.00], Avg: 165.2694 (0.020)
Step: 65481, Reward: 200.0000 [0.00], Avg: 165.3436 (0.020)
Step: 65681, Reward: 200.0000 [0.00], Avg: 165.4175 (0.020)
Step: 65881, Reward: 200.0000 [0.00], Avg: 165.4911 (0.020)
Step: 66081, Reward: 200.0000 [0.00], Avg: 165.5644 (0.020)
Step: 66281, Reward: 200.0000 [0.00], Avg: 165.6373 (0.020)
Step: 66481, Reward: 200.0000 [0.00], Avg: 165.7100 (0.020)
Step: 66681, Reward: 200.0000 [0.00], Avg: 165.7823 (0.020)
Step: 66881, Reward: 200.0000 [0.00], Avg: 165.8544 (0.020)
Step: 67081, Reward: 168.0000 [6.96], Avg: 165.8443 (0.020)
Step: 67223, Reward: 200.0000 [0.00], Avg: 165.9159 (0.020)
Step: 67423, Reward: 200.0000 [0.00], Avg: 165.9872 (0.020)
Step: 67623, Reward: 200.0000 [0.00], Avg: 166.0582 (0.020)
Step: 67758, Reward: 200.0000 [0.00], Avg: 166.1289 (0.020)
Step: 67958, Reward: 200.0000 [0.00], Avg: 166.1993 (0.020)
Step: 68158, Reward: 200.0000 [0.00], Avg: 166.2694 (0.020)
Step: 68345, Reward: 188.0000 [8.37], Avg: 166.2971 (0.020)
Step: 68545, Reward: 200.0000 [0.00], Avg: 166.3667 (0.020)
Step: 68745, Reward: 200.0000 [0.00], Avg: 166.4361 (0.020)
Step: 68945, Reward: 200.0000 [0.00], Avg: 166.5051 (0.020)
Step: 69145, Reward: 200.0000 [0.00], Avg: 166.5739 (0.020)
Step: 69318, Reward: 195.6000 [8.80], Avg: 166.6154 (0.020)
Step: 69501, Reward: 180.6000 [11.11], Avg: 166.6212 (0.020)
Step: 69661, Reward: 182.4000 [27.50], Avg: 166.5973 (0.020)
Step: 69856, Reward: 200.0000 [0.00], Avg: 166.6654 (0.020)
Step: 70056, Reward: 200.0000 [0.00], Avg: 166.7331 (0.020)
Step: 70256, Reward: 200.0000 [0.00], Avg: 166.8006 (0.020)
Step: 70437, Reward: 200.0000 [0.00], Avg: 166.8678 (0.020)
Step: 70633, Reward: 200.0000 [0.00], Avg: 166.9347 (0.020)
Step: 70833, Reward: 200.0000 [0.00], Avg: 167.0014 (0.020)
Step: 71033, Reward: 200.0000 [0.00], Avg: 167.0678 (0.020)
Step: 71233, Reward: 200.0000 [0.00], Avg: 167.1339 (0.020)
Step: 71433, Reward: 200.0000 [0.00], Avg: 167.1998 (0.020)
Step: 71633, Reward: 200.0000 [0.00], Avg: 167.2654 (0.020)
Step: 71833, Reward: 200.0000 [0.00], Avg: 167.3307 (0.020)
Step: 72033, Reward: 200.0000 [0.00], Avg: 167.3958 (0.020)
Step: 72233, Reward: 200.0000 [0.00], Avg: 167.4606 (0.020)
Step: 72433, Reward: 186.2000 [9.56], Avg: 167.4788 (0.020)
Step: 72633, Reward: 200.0000 [0.00], Avg: 167.5432 (0.020)
Step: 72833, Reward: 200.0000 [0.00], Avg: 167.6074 (0.020)
Step: 73033, Reward: 200.0000 [0.00], Avg: 167.6713 (0.020)
Step: 73233, Reward: 200.0000 [0.00], Avg: 167.7349 (0.020)
Step: 73433, Reward: 200.0000 [0.00], Avg: 167.7983 (0.020)
Step: 73633, Reward: 200.0000 [0.00], Avg: 167.8614 (0.020)
Step: 73833, Reward: 200.0000 [0.00], Avg: 167.9243 (0.020)
Step: 74033, Reward: 200.0000 [0.00], Avg: 167.9870 (0.020)
Step: 74233, Reward: 200.0000 [0.00], Avg: 168.0494 (0.020)
Step: 74433, Reward: 200.0000 [0.00], Avg: 168.1115 (0.020)
Step: 74633, Reward: 200.0000 [0.00], Avg: 168.1735 (0.020)
Step: 74833, Reward: 200.0000 [0.00], Avg: 168.2351 (0.020)
Step: 75033, Reward: 200.0000 [0.00], Avg: 168.2966 (0.020)
Step: 75233, Reward: 200.0000 [0.00], Avg: 168.3578 (0.020)
Step: 75433, Reward: 200.0000 [0.00], Avg: 168.4187 (0.020)
Step: 75633, Reward: 200.0000 [0.00], Avg: 168.4795 (0.020)
Step: 75833, Reward: 200.0000 [0.00], Avg: 168.5400 (0.020)
Step: 76033, Reward: 200.0000 [0.00], Avg: 168.6002 (0.020)
Step: 76214, Reward: 200.0000 [0.00], Avg: 168.6603 (0.020)
Step: 76414, Reward: 195.2000 [9.60], Avg: 168.6926 (0.020)
Step: 76614, Reward: 200.0000 [0.00], Avg: 168.7522 (0.020)
Step: 76814, Reward: 200.0000 [0.00], Avg: 168.8117 (0.020)
Step: 77014, Reward: 200.0000 [0.00], Avg: 168.8708 (0.020)
Step: 77214, Reward: 200.0000 [0.00], Avg: 168.9298 (0.020)
Step: 77414, Reward: 200.0000 [0.00], Avg: 168.9885 (0.020)
Step: 77614, Reward: 200.0000 [0.00], Avg: 169.0470 (0.020)
Step: 77814, Reward: 200.0000 [0.00], Avg: 169.1053 (0.020)
Step: 78014, Reward: 200.0000 [0.00], Avg: 169.1634 (0.020)
Step: 78214, Reward: 199.8000 [0.40], Avg: 169.2201 (0.020)
Step: 78414, Reward: 197.0000 [6.00], Avg: 169.2609 (0.020)
Step: 78614, Reward: 200.0000 [0.00], Avg: 169.3184 (0.020)
Step: 78814, Reward: 200.0000 [0.00], Avg: 169.3756 (0.020)
Step: 79014, Reward: 200.0000 [0.00], Avg: 169.4326 (0.020)
Step: 79214, Reward: 200.0000 [0.00], Avg: 169.4895 (0.020)
Step: 79414, Reward: 200.0000 [0.00], Avg: 169.5461 (0.020)
Step: 79614, Reward: 200.0000 [0.00], Avg: 169.6025 (0.020)
Step: 79814, Reward: 200.0000 [0.00], Avg: 169.6587 (0.020)
Step: 80014, Reward: 200.0000 [0.00], Avg: 169.7146 (0.020)
Step: 80214, Reward: 200.0000 [0.00], Avg: 169.7704 (0.020)
Step: 80414, Reward: 200.0000 [0.00], Avg: 169.8260 (0.020)
Step: 80614, Reward: 200.0000 [0.00], Avg: 169.8813 (0.020)
Step: 80814, Reward: 200.0000 [0.00], Avg: 169.9365 (0.020)
Step: 81014, Reward: 200.0000 [0.00], Avg: 169.9915 (0.020)
Step: 81160, Reward: 200.0000 [0.00], Avg: 170.0462 (0.020)
Step: 81360, Reward: 200.0000 [0.00], Avg: 170.1008 (0.020)
Step: 81560, Reward: 198.6000 [2.80], Avg: 170.1475 (0.020)
Step: 81711, Reward: 200.0000 [0.00], Avg: 170.2017 (0.020)
Step: 81911, Reward: 200.0000 [0.00], Avg: 170.2557 (0.020)
Step: 82111, Reward: 200.0000 [0.00], Avg: 170.3095 (0.020)
Step: 82311, Reward: 200.0000 [0.00], Avg: 170.3631 (0.020)
Step: 82511, Reward: 200.0000 [0.00], Avg: 170.4165 (0.020)
Step: 82711, Reward: 200.0000 [0.00], Avg: 170.4697 (0.020)
Step: 82911, Reward: 200.0000 [0.00], Avg: 170.5227 (0.020)
Step: 83111, Reward: 200.0000 [0.00], Avg: 170.5755 (0.020)
Step: 83311, Reward: 200.0000 [0.00], Avg: 170.6281 (0.020)
Step: 83504, Reward: 200.0000 [0.00], Avg: 170.6806 (0.020)
Step: 83704, Reward: 200.0000 [0.00], Avg: 170.7329 (0.020)
Step: 83904, Reward: 200.0000 [0.00], Avg: 170.7849 (0.020)
Step: 84104, Reward: 200.0000 [0.00], Avg: 170.8368 (0.020)
Step: 84304, Reward: 200.0000 [0.00], Avg: 170.8885 (0.020)
Step: 84504, Reward: 200.0000 [0.00], Avg: 170.9401 (0.020)
Step: 84704, Reward: 200.0000 [0.00], Avg: 170.9914 (0.020)
Step: 84904, Reward: 200.0000 [0.00], Avg: 171.0426 (0.020)
Step: 85104, Reward: 200.0000 [0.00], Avg: 171.0935 (0.020)
Step: 85304, Reward: 200.0000 [0.00], Avg: 171.1443 (0.020)
Step: 85504, Reward: 200.0000 [0.00], Avg: 171.1950 (0.020)
Step: 85704, Reward: 200.0000 [0.00], Avg: 171.2454 (0.020)
Step: 85904, Reward: 200.0000 [0.00], Avg: 171.2957 (0.020)
Step: 86104, Reward: 200.0000 [0.00], Avg: 171.3458 (0.020)
Step: 86264, Reward: 188.2000 [19.42], Avg: 171.3413 (0.020)
Step: 86464, Reward: 161.6000 [42.28], Avg: 171.2508 (0.020)
Step: 86604, Reward: 194.8000 [10.40], Avg: 171.2737 (0.020)
Step: 86804, Reward: 200.0000 [0.00], Avg: 171.3235 (0.020)
Step: 87004, Reward: 189.0000 [22.00], Avg: 171.3160 (0.020)
Step: 87204, Reward: 186.6000 [17.08], Avg: 171.3129 (0.020)
Step: 87404, Reward: 199.4000 [1.20], Avg: 171.3592 (0.020)
Step: 87604, Reward: 200.0000 [0.00], Avg: 171.4085 (0.020)
Step: 87804, Reward: 200.0000 [0.00], Avg: 171.4577 (0.020)
Step: 88004, Reward: 191.4000 [17.20], Avg: 171.4624 (0.020)
Step: 88191, Reward: 198.4000 [3.20], Avg: 171.5030 (0.020)
Step: 88391, Reward: 200.0000 [0.00], Avg: 171.5517 (0.020)
Step: 88591, Reward: 200.0000 [0.00], Avg: 171.6003 (0.020)
Step: 88791, Reward: 200.0000 [0.00], Avg: 171.6486 (0.020)
Step: 88991, Reward: 200.0000 [0.00], Avg: 171.6969 (0.020)
Step: 89191, Reward: 187.2000 [25.60], Avg: 171.6797 (0.020)
Step: 89391, Reward: 200.0000 [0.00], Avg: 171.7277 (0.020)
Step: 89591, Reward: 200.0000 [0.00], Avg: 171.7756 (0.020)
Step: 89791, Reward: 200.0000 [0.00], Avg: 171.8232 (0.020)
Step: 89969, Reward: 199.4000 [1.20], Avg: 171.8677 (0.020)
Step: 90169, Reward: 200.0000 [0.00], Avg: 171.9151 (0.020)
Step: 90369, Reward: 197.6000 [4.80], Avg: 171.9502 (0.020)
Step: 90569, Reward: 198.0000 [4.00], Avg: 171.9872 (0.020)
Step: 90756, Reward: 200.0000 [0.00], Avg: 172.0341 (0.020)
Step: 90956, Reward: 200.0000 [0.00], Avg: 172.0809 (0.020)
Step: 91156, Reward: 195.4000 [9.20], Avg: 172.1044 (0.020)
Step: 91356, Reward: 200.0000 [0.00], Avg: 172.1509 (0.020)
Step: 91556, Reward: 159.0000 [53.14], Avg: 172.0406 (0.020)
Step: 91756, Reward: 200.0000 [0.00], Avg: 172.0871 (0.020)
Step: 91956, Reward: 200.0000 [0.00], Avg: 172.1334 (0.020)
Step: 92156, Reward: 190.4000 [11.60], Avg: 172.1444 (0.020)
Step: 92280, Reward: 193.2000 [13.60], Avg: 172.1567 (0.020)
Step: 92480, Reward: 200.0000 [0.00], Avg: 172.2027 (0.020)
Step: 92680, Reward: 200.0000 [0.00], Avg: 172.2484 (0.020)
Step: 92880, Reward: 200.0000 [0.00], Avg: 172.2941 (0.020)
Step: 93080, Reward: 200.0000 [0.00], Avg: 172.3396 (0.020)
Step: 93280, Reward: 200.0000 [0.00], Avg: 172.3849 (0.020)
Step: 93466, Reward: 200.0000 [0.00], Avg: 172.4301 (0.020)
Step: 93658, Reward: 200.0000 [0.00], Avg: 172.4752 (0.020)
Step: 93858, Reward: 185.2000 [13.08], Avg: 172.4746 (0.020)
Step: 94058, Reward: 200.0000 [0.00], Avg: 172.5194 (0.020)
Step: 94258, Reward: 200.0000 [0.00], Avg: 172.5641 (0.020)
Step: 94458, Reward: 200.0000 [0.00], Avg: 172.6087 (0.020)
Step: 94644, Reward: 179.8000 [17.99], Avg: 172.5912 (0.020)
Step: 94844, Reward: 200.0000 [0.00], Avg: 172.6355 (0.020)
Step: 95044, Reward: 200.0000 [0.00], Avg: 172.6797 (0.020)
Step: 95244, Reward: 200.0000 [0.00], Avg: 172.7238 (0.020)
Step: 95444, Reward: 200.0000 [0.00], Avg: 172.7677 (0.020)
Step: 95644, Reward: 200.0000 [0.00], Avg: 172.8115 (0.020)
Step: 95844, Reward: 200.0000 [0.00], Avg: 172.8551 (0.020)
Step: 96044, Reward: 200.0000 [0.00], Avg: 172.8986 (0.020)
Step: 96244, Reward: 200.0000 [0.00], Avg: 172.9420 (0.020)
Step: 96432, Reward: 200.0000 [0.00], Avg: 172.9852 (0.020)
Step: 96632, Reward: 200.0000 [0.00], Avg: 173.0283 (0.020)
Step: 96832, Reward: 200.0000 [0.00], Avg: 173.0712 (0.020)
Step: 97032, Reward: 200.0000 [0.00], Avg: 173.1141 (0.020)
Step: 97232, Reward: 200.0000 [0.00], Avg: 173.1567 (0.020)
Step: 97432, Reward: 200.0000 [0.00], Avg: 173.1993 (0.020)
Step: 97632, Reward: 200.0000 [0.00], Avg: 173.2417 (0.020)
Step: 97832, Reward: 200.0000 [0.00], Avg: 173.2839 (0.020)
Step: 98032, Reward: 200.0000 [0.00], Avg: 173.3261 (0.020)
Step: 98232, Reward: 200.0000 [0.00], Avg: 173.3681 (0.020)
Step: 98432, Reward: 200.0000 [0.00], Avg: 173.4100 (0.020)
Step: 98632, Reward: 200.0000 [0.00], Avg: 173.4517 (0.020)
Step: 98822, Reward: 196.2000 [5.81], Avg: 173.4783 (0.020)
Step: 99022, Reward: 200.0000 [0.00], Avg: 173.5198 (0.020)
Step: 99222, Reward: 200.0000 [0.00], Avg: 173.5611 (0.020)
Step: 99422, Reward: 200.0000 [0.00], Avg: 173.6024 (0.020)
Step: 99622, Reward: 200.0000 [0.00], Avg: 173.6435 (0.020)
Step: 99822, Reward: 200.0000 [0.00], Avg: 173.6845 (0.020)

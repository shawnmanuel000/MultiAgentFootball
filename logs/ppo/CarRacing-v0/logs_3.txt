Model: <class 'models.ppo.PPOAgent'>, Dir: CarRacing-v0
num_envs: 16, state_size: (96, 96, 3), action_size: (3,),

import gym
import torch
import pickle
import argparse
import numpy as np
from models.rand import ReplayBuffer, PrioritizedReplayBuffer
from utils.network import PTACNetwork, PTACAgent, Conv, INPUT_LAYER, ACTOR_HIDDEN, CRITIC_HIDDEN, LEARN_RATE, DISCOUNT_RATE, NUM_STEPS, ADVANTAGE_DECAY

BATCH_SIZE = 32					# Number of samples to train on for each train step
PPO_EPOCHS = 2					# Number of iterations to sample batches for training
ENTROPY_WEIGHT = 0.005			# The weight for the entropy term of the Actor loss
CLIP_PARAM = 0.05				# The limit of the ratio of new action probabilities to old probabilities

class PPOActor(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, ACTOR_HIDDEN)
		self.layer3 = torch.nn.Linear(ACTOR_HIDDEN, ACTOR_HIDDEN)
		self.action_mu = torch.nn.Linear(ACTOR_HIDDEN, *action_size)
		self.action_sig = torch.nn.Parameter(torch.zeros(*action_size))
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)
		
	def forward(self, state, action=None, sample=True):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		action_mu = self.action_mu(state)
		action_sig = self.action_sig.exp().expand_as(action_mu)
		dist = torch.distributions.Normal(action_mu, action_sig)
		action = dist.sample() if action is None else action
		log_prob = dist.log_prob(action)
		entropy = dist.entropy()
		return action, log_prob, entropy

class PPOCritic(torch.nn.Module):
	def __init__(self, state_size, action_size):
		super().__init__()
		self.layer1 = torch.nn.Linear(state_size[-1], INPUT_LAYER) if len(state_size)==1 else Conv(state_size, INPUT_LAYER)
		self.layer2 = torch.nn.Linear(INPUT_LAYER, CRITIC_HIDDEN)
		self.layer3 = torch.nn.Linear(CRITIC_HIDDEN, CRITIC_HIDDEN)
		self.value = torch.nn.Linear(CRITIC_HIDDEN, 1)
		self.apply(lambda m: torch.nn.init.xavier_normal_(m.weight) if type(m) in [torch.nn.Conv2d, torch.nn.Linear] else None)

	def forward(self, state):
		state = self.layer1(state).relu()
		state = self.layer2(state).relu()
		state = self.layer3(state).relu()
		value = self.value(state)
		return value

class PPONetwork(PTACNetwork):
	def __init__(self, state_size, action_size, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPOActor, PPOCritic, lr=lr, gpu=gpu, load=load)

	def get_action_probs(self, state, action_in=None, sample=True, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			action, log_prob, entropy = self.actor_local(state.to(self.device), action_in, sample)
			return action if action_in is None else entropy.mean(), log_prob

	def get_value(self, state, grad=True):
		with torch.enable_grad() if grad else torch.no_grad():
			return self.critic_local(state.to(self.device))

	def optimize(self, states, actions, old_log_probs, targets, advantages, importances=torch.scalar_tensor(1), clip_param=CLIP_PARAM, e_weight=ENTROPY_WEIGHT, scale=1):
		values = self.get_value(states)
		critic_error = values - targets
		critic_loss = importances.to(self.device) * critic_error.pow(2) * scale
		self.step(self.critic_optimizer, critic_loss.mean())

		entropy, new_log_probs = self.get_action_probs(states, actions)
		ratio = (new_log_probs - old_log_probs).exp()
		ratio_clipped = torch.clamp(ratio, 1.0-clip_param, 1.0+clip_param)
		actor_loss = -(torch.min(ratio*advantages, ratio_clipped*advantages) + e_weight*entropy) * scale
		self.step(self.actor_optimizer, actor_loss.mean())
		return critic_error.cpu().detach().numpy().squeeze(-1)

	def save_model(self, dirname="pytorch", name="best"):
		super().save_model("ppo", dirname, name)
		
	def load_model(self, dirname="pytorch", name="best"):
		super().load_model("ppo", dirname, name)

class PPOAgent(PTACAgent):
	def __init__(self, state_size, action_size, update_freq=NUM_STEPS, lr=LEARN_RATE, gpu=True, load=None):
		super().__init__(state_size, action_size, PPONetwork, lr=lr, update_freq=update_freq, gpu=gpu, load=load)

	def get_action(self, state, eps=None, sample=True):
		state = self.to_tensor(state)
		self.action, self.log_prob = [x.cpu().numpy() for x in self.network.get_action_probs(state, sample=sample, grad=False)]
		return np.tanh(self.action)

	def train(self, state, action, next_state, reward, done):
		self.buffer.append((state, self.action, self.log_prob, reward, done))
		if done[0] or len(self.buffer) >= self.update_freq:
			states, actions, log_probs, rewards, dones = map(self.to_tensor, zip(*self.buffer))
			self.buffer.clear()
			next_state = self.to_tensor(next_state)
			values = self.network.get_value(states, grad=False)
			next_value = self.network.get_value(next_state, grad=False)
			targets, advantages = self.compute_gae(next_value, rewards.unsqueeze(-1), dones.unsqueeze(-1), values, gamma=DISCOUNT_RATE, lamda=ADVANTAGE_DECAY)
			states, actions, log_probs, targets, advantages = [x.view(x.size(0)*x.size(1), *x.size()[2:]) for x in (states, actions, log_probs, targets, advantages)]
			self.replay_buffer.clear().extend(list(zip(states, actions, log_probs, targets, advantages)), shuffle=True)
			for _ in range((len(self.replay_buffer)*PPO_EPOCHS)//BATCH_SIZE):
				state, action, log_prob, target, advantage = self.replay_buffer.next_batch(BATCH_SIZE, torch.stack)
				self.network.optimize(state, action, log_prob, target, advantage, scale=16*dones.size(0)/len(self.replay_buffer))

REG_LAMBDA = 1e-6             	# Penalty multiplier to apply for the size of the network weights
LEARN_RATE = 0.0001           	# Sets how much we want to update the network weights at each training step
TARGET_UPDATE_RATE = 0.0004   	# How frequently we want to copy the local network to the target network (for double DQNs)
INPUT_LAYER = 512				# The number of output nodes from the first layer to Actor and Critic networks
ACTOR_HIDDEN = 256				# The number of nodes in the hidden layers of the Actor network
CRITIC_HIDDEN = 1024			# The number of nodes in the hidden layers of the Critic networks
DISCOUNT_RATE = 0.99			# The discount rate to use in the Bellman Equation
NUM_STEPS = 500 				# The number of steps to collect experience in sequence for each GAE calculation
EPS_MAX = 1.0                 	# The starting proportion of random to greedy actions to take
EPS_MIN = 0.020               	# The lower limit proportion of random to greedy actions to take
EPS_DECAY = 0.980             	# The rate at which eps decays from EPS_MAX to EPS_MIN
ADVANTAGE_DECAY = 0.95			# The discount factor for the cumulative GAE calculation
MAX_BUFFER_SIZE = 100000      	# Sets the maximum length of the replay buffer

import gym
import argparse
import numpy as np
# import gfootball.env as ggym
from collections import deque
from models.ppo import PPOAgent
from models.ddqn import DDQNAgent
from models.ddpg import DDPGAgent
from models.rand import RandomAgent
from utils.envs import EnsembleEnv, EnvManager, EnvWorker, ImgStack, RawStack
from utils.misc import Logger, rollout

parser = argparse.ArgumentParser(description="A3C Trainer")
parser.add_argument("--workerports", type=int, default=[16], nargs="+", help="The list of worker ports to connect to")
parser.add_argument("--selfport", type=int, default=None, help="Which port to listen on (as a worker server)")
parser.add_argument("--model", type=str, default="ddpg", choices=["ddqn", "ddpg", "ppo", "rand"], help="Which reinforcement learning algorithm to use")
parser.add_argument("--steps", type=int, default=100000, help="Number of steps to train the agent")
args = parser.parse_args()

gym_envs = ["CartPole-v0", "MountainCar-v0", "Acrobot-v1", "Pendulum-v0", "MountainCarContinuous-v0", "CarRacing-v0", "BipedalWalker-v2", "LunarLander-v2"]
gfb_envs = ["11_vs_11_stochastic", "academy_empty_goal_close"]
env_name = gym_envs[5]

def make_env(env_name=env_name, log=False):
	if env_name in gym_envs: return gym.make(env_name)
	reps = ["pixels", "pixels_gray", "extracted", "simple115"]
	env = ggym.create_environment(env_name=env_name, representation=reps[3], logdir='/football/logs/', render=False)
	env.spec = gym.envs.registration.EnvSpec(env_name + "-v0", max_episode_steps=env.unwrapped._config._scenario_cfg.game_duration)
	if log: print(f"State space: {env.observation_space.shape} \nAction space: {env.action_space.n}")
	return env

class PixelAgent(RandomAgent):
	def __init__(self, state_size, action_size, num_envs, agent, load="", gpu=True, train=True):
		super().__init__(state_size, action_size)
		statemodel = RawStack if len(state_size) == 1 else ImgStack
		self.stack = statemodel(state_size, num_envs, load=load, gpu=gpu)
		self.agent = agent(self.stack.state_size, action_size, load="" if train else load, gpu=gpu)

	def get_env_action(self, env, state, eps=None, sample=True):
		state = self.stack.get_state(state)
		env_action, action = self.agent.get_env_action(env, state, eps, sample)
		return env_action, action, state

	def train(self, state, action, next_state, reward, done):
		next_state = self.stack.get_state(next_state)
		self.agent.train(state, action, next_state, reward, done)

	def reset(self, num_envs=None):
		num_envs = self.stack.num_envs if num_envs is None else num_envs
		self.stack.reset(num_envs, restore=False)
		return self

	def save_model(self, dirname="pytorch", name="best"):
		if hasattr(self.agent, "network"): self.agent.network.save_model(dirname, name)

def run(model, steps=10000, ports=16, eval_at=1000):
	num_envs = len(ports) if type(ports) == list else min(ports, 64)
	envs = EnvManager(make_env, ports) if type(ports) == list else EnsembleEnv(make_env, ports)
	logger = Logger(model, env_name, num_envs=num_envs, state_size=envs.state_size, action_size=envs.action_size)
	agent = PixelAgent(envs.state_size, envs.action_size, num_envs, model)
	states = envs.reset()
	total_rewards = []
	for s in range(steps):
		agent.reset(num_envs)
		env_actions, actions, states = agent.get_env_action(envs.env, states)
		next_states, rewards, dones, _ = envs.step(env_actions)
		agent.train(states, actions, next_states, rewards, dones)
		states = next_states
		if dones[0]:
			rollouts = [rollout(envs.env, agent.reset(1)) for _ in range(5)]
			test_reward = np.mean(rollouts) - np.std(rollouts)
			total_rewards.append(test_reward)
			agent.save_model(env_name, "checkpoint")
			if env_name in gfb_envs and total_rewards[-1] >= max(total_rewards): agent.save_model(env_name)
			logger.log(f"Step: {s}, Reward: {test_reward+np.std(rollouts):.4f} [{np.std(rollouts):.2f}], Avg: {np.mean(total_rewards):.4f} ({agent.agent.eps:.3f})")

if __name__ == "__main__":
	model = DDPGAgent if args.model == "ddpg" else PPOAgent if args.model == "ppo" else DDQNAgent if args.model == "ddqn" else RandomAgent
	if args.selfport is not None:
		EnvWorker(args.selfport, make_env).start()
	else:
		if len(args.workerports) == 1: args.workerports = args.workerports[0]
		run(model, args.steps, args.workerports)
	print(f"Training finished")

Step: 999, Reward: -56.3152 [4.13], Avg: -60.4496 (1.000)
Step: 1999, Reward: -53.5771 [3.31], Avg: -58.6662 (1.000)
Step: 2999, Reward: -51.5681 [3.96], Avg: -57.6204 (1.000)
Step: 3999, Reward: -51.0119 [2.93], Avg: -56.7014 (1.000)
Step: 4999, Reward: -49.2531 [4.49], Avg: -56.1093 (1.000)
Step: 5999, Reward: -47.3609 [5.82], Avg: -55.6212 (1.000)
Step: 6999, Reward: -47.2590 [2.25], Avg: -54.7482 (1.000)
Step: 7999, Reward: -44.7438 [1.58], Avg: -53.6946 (1.000)
Step: 8999, Reward: -40.1697 [4.28], Avg: -52.6677 (1.000)
Step: 9999, Reward: -38.8601 [2.13], Avg: -51.5001 (1.000)
Step: 10999, Reward: -35.0988 [4.73], Avg: -50.4393 (1.000)
Step: 11999, Reward: -31.2628 [2.64], Avg: -49.0612 (1.000)
Step: 12999, Reward: -29.1808 [3.50], Avg: -47.8013 (1.000)
Step: 13999, Reward: -26.6018 [10.25], Avg: -47.0191 (1.000)
Step: 14999, Reward: -27.8634 [6.80], Avg: -46.1954 (1.000)
Step: 15999, Reward: -29.9268 [7.79], Avg: -45.6653 (1.000)
Step: 16999, Reward: -30.7698 [8.09], Avg: -45.2649 (1.000)
Step: 17999, Reward: -24.8783 [8.87], Avg: -44.6249 (1.000)
Step: 18999, Reward: -25.8394 [13.23], Avg: -44.3323 (1.000)
Step: 19999, Reward: -10.6959 [21.18], Avg: -43.7094 (1.000)
Step: 20999, Reward: -24.8010 [9.75], Avg: -43.2731 (1.000)
Step: 21999, Reward: -17.2516 [10.72], Avg: -42.5777 (1.000)
Step: 22999, Reward: -22.0535 [6.91], Avg: -41.9857 (1.000)
Step: 23999, Reward: -22.2537 [6.67], Avg: -41.4414 (1.000)
Step: 24999, Reward: -32.0261 [12.91], Avg: -41.5811 (1.000)
Step: 25999, Reward: -34.5810 [6.04], Avg: -41.5443 (1.000)
Step: 26999, Reward: -0.7504 [25.07], Avg: -40.9619 (1.000)
Step: 27999, Reward: -21.0982 [12.01], Avg: -40.6815 (1.000)
Step: 28999, Reward: -19.7136 [31.49], Avg: -41.0444 (1.000)
Step: 29999, Reward: -19.2406 [15.78], Avg: -40.8435 (1.000)
Step: 30999, Reward: -14.4222 [36.45], Avg: -41.1670 (1.000)
Step: 31999, Reward: -34.7746 [13.35], Avg: -41.3845 (1.000)
Step: 32999, Reward: -41.4117 [12.98], Avg: -41.7786 (1.000)
Step: 33999, Reward: -18.3277 [12.23], Avg: -41.4485 (1.000)
Step: 34999, Reward: -18.3928 [21.84], Avg: -41.4137 (1.000)
Step: 35999, Reward: -21.5479 [10.15], Avg: -41.1439 (1.000)
Step: 36999, Reward: -22.0774 [2.73], Avg: -40.7024 (1.000)
Step: 37999, Reward: -16.4436 [16.62], Avg: -40.5015 (1.000)
Step: 38999, Reward: -2.9499 [47.54], Avg: -40.7576 (1.000)
Step: 39999, Reward: -16.3379 [41.64], Avg: -41.1881 (1.000)
Step: 40999, Reward: 0.5909 [30.64], Avg: -40.9163 (1.000)
Step: 41999, Reward: -23.2389 [5.53], Avg: -40.6269 (1.000)
Step: 42999, Reward: -25.7311 [19.44], Avg: -40.7327 (1.000)
Step: 43999, Reward: 125.4444 [46.25], Avg: -38.0071 (1.000)
Step: 44999, Reward: -8.7176 [31.40], Avg: -38.0540 (1.000)
Step: 45999, Reward: 72.3043 [115.17], Avg: -38.1587 (1.000)
Step: 46999, Reward: 153.8518 [81.15], Avg: -35.8000 (1.000)
Step: 47999, Reward: 194.1723 [75.64], Avg: -32.5848 (1.000)
Step: 48999, Reward: 290.2862 [114.62], Avg: -28.3347 (1.000)
Step: 49999, Reward: 99.6199 [120.31], Avg: -28.1818 (1.000)
Step: 50999, Reward: 221.0494 [167.91], Avg: -26.5873 (1.000)
Step: 51999, Reward: 242.0949 [173.67], Avg: -24.7602 (1.000)
Step: 52999, Reward: 289.0427 [185.80], Avg: -22.3451 (1.000)
Step: 53999, Reward: 348.3561 [170.25], Avg: -18.6330 (1.000)
Step: 54999, Reward: 443.4661 [113.82], Avg: -12.3006 (1.000)
Step: 55999, Reward: 318.2681 [254.15], Avg: -10.9360 (1.000)
Step: 56999, Reward: 501.5683 [112.39], Avg: -3.9164 (1.000)
Step: 57999, Reward: 419.3018 [217.71], Avg: -0.3732 (1.000)
Step: 58999, Reward: 515.6320 [268.80], Avg: 3.8167 (1.000)
Step: 59999, Reward: 658.5656 [42.80], Avg: 14.0158 (1.000)
Step: 60999, Reward: 686.8598 [198.54], Avg: 21.7913 (1.000)
Step: 61999, Reward: 690.2852 [67.49], Avg: 31.4850 (1.000)
Step: 62999, Reward: 746.1884 [88.28], Avg: 41.4282 (1.000)
Step: 63999, Reward: 497.6905 [200.72], Avg: 45.4210 (1.000)
Step: 64999, Reward: 560.1397 [317.41], Avg: 48.4566 (1.000)
Step: 65999, Reward: 796.7621 [153.68], Avg: 57.4661 (1.000)
Step: 66781, Reward: 678.4271 [208.15], Avg: 63.6275 (1.000)
Step: 67781, Reward: 498.2926 [203.76], Avg: 67.0231 (1.000)
Step: 68781, Reward: 528.5816 [49.59], Avg: 72.9937 (1.000)
Step: 69781, Reward: 606.7173 [214.81], Avg: 77.5497 (1.000)
Step: 70754, Reward: 647.4753 [112.57], Avg: 83.9913 (1.000)
Step: 71754, Reward: 610.1536 [301.02], Avg: 87.1182 (1.000)
Step: 72754, Reward: 669.2721 [259.68], Avg: 91.5356 (1.000)
Step: 73754, Reward: 728.2969 [129.16], Avg: 98.3951 (1.000)
Step: 74754, Reward: 845.2997 [44.13], Avg: 107.7653 (1.000)
Step: 75754, Reward: 668.2533 [270.63], Avg: 111.5793 (1.000)
Step: 76754, Reward: 772.4542 [161.62], Avg: 118.0632 (1.000)
Step: 77754, Reward: 749.9658 [154.37], Avg: 124.1853 (1.000)
Step: 78534, Reward: 744.5832 [174.63], Avg: 129.8279 (1.000)
Step: 79534, Reward: 765.3585 [81.27], Avg: 136.7562 (1.000)
Step: 80378, Reward: 723.6855 [266.87], Avg: 140.7075 (1.000)
Step: 81378, Reward: 663.7097 [216.47], Avg: 144.4457 (1.000)
Step: 82378, Reward: 816.4776 [74.04], Avg: 151.6504 (1.000)
Step: 83097, Reward: 755.3627 [223.69], Avg: 156.1745 (1.000)
Step: 84097, Reward: 803.6472 [115.58], Avg: 162.4321 (1.000)
Step: 85097, Reward: 853.7707 [37.71], Avg: 170.0324 (1.000)
Step: 86097, Reward: 744.9490 [116.18], Avg: 175.3053 (1.000)
Step: 87097, Reward: 659.5505 [171.47], Avg: 178.8596 (1.000)
Step: 88097, Reward: 875.4451 [26.25], Avg: 186.3914 (1.000)
Step: 89097, Reward: 674.1088 [247.12], Avg: 189.0647 (1.000)
Step: 90097, Reward: 768.9323 [148.16], Avg: 193.8088 (1.000)
Step: 91097, Reward: 402.7479 [195.59], Avg: 193.9539 (1.000)
Step: 92097, Reward: 730.9724 [164.40], Avg: 197.9606 (1.000)
Step: 93097, Reward: 688.8793 [143.68], Avg: 201.6547 (1.000)
Step: 94097, Reward: 630.2504 [158.97], Avg: 204.4929 (1.000)
Step: 95097, Reward: 821.1948 [51.86], Avg: 210.3767 (1.000)
Step: 96097, Reward: 579.8844 [113.39], Avg: 213.0171 (1.000)
Step: 97097, Reward: 583.6076 [218.55], Avg: 214.5686 (1.000)
Step: 98097, Reward: 646.8681 [176.93], Avg: 217.1480 (1.000)
Step: 99097, Reward: 740.3058 [114.45], Avg: 221.2352 (1.000)
Step: 100097, Reward: 662.5596 [169.29], Avg: 223.9286 (1.000)
Step: 101097, Reward: 655.5954 [139.34], Avg: 226.7946 (1.000)
Step: 102097, Reward: 593.5856 [225.48], Avg: 228.1666 (1.000)
Step: 103097, Reward: 672.1524 [152.77], Avg: 230.9668 (1.000)
Step: 104097, Reward: 506.6021 [290.59], Avg: 230.8244 (1.000)
Step: 105097, Reward: 739.3988 [149.33], Avg: 234.2134 (1.000)
Step: 106097, Reward: 527.4702 [88.21], Avg: 236.1297 (1.000)
Step: 107097, Reward: 636.5825 [321.68], Avg: 236.8591 (1.000)
Step: 108034, Reward: 676.3007 [212.62], Avg: 238.9400 (1.000)
Step: 109034, Reward: 811.8781 [123.67], Avg: 243.0243 (1.000)
Step: 110034, Reward: 610.1899 [186.62], Avg: 244.6508 (1.000)
Step: 111034, Reward: 613.8224 [283.54], Avg: 245.4154 (1.000)
Step: 112034, Reward: 768.8932 [126.97], Avg: 248.9243 (1.000)
Step: 113034, Reward: 854.6317 [39.85], Avg: 253.8879 (1.000)
Step: 113830, Reward: 794.1862 [100.41], Avg: 257.7130 (1.000)
Step: 114830, Reward: 810.5322 [126.90], Avg: 261.3847 (1.000)
Step: 115830, Reward: 758.3767 [178.22], Avg: 264.1092 (1.000)
Step: 116830, Reward: 726.6085 [247.53], Avg: 265.9310 (1.000)
Step: 117830, Reward: 794.7148 [74.08], Avg: 269.7521 (1.000)
Step: 118830, Reward: 619.3332 [181.49], Avg: 271.1529 (1.000)
Step: 119830, Reward: 650.8111 [191.51], Avg: 272.7078 (1.000)
Step: 120830, Reward: 733.7242 [192.64], Avg: 274.9077 (1.000)
Step: 121830, Reward: 711.8985 [229.09], Avg: 276.5979 (1.000)
Step: 122830, Reward: 645.3549 [186.97], Avg: 278.0640 (1.000)
Step: 123830, Reward: 615.8928 [183.20], Avg: 279.3010 (1.000)
Step: 124830, Reward: 713.9447 [122.31], Avg: 281.7799 (1.000)
Step: 125830, Reward: 567.8388 [299.98], Avg: 281.6703 (1.000)
Step: 126830, Reward: 608.5485 [223.77], Avg: 282.4759 (1.000)
Step: 127830, Reward: 566.7348 [169.92], Avg: 283.3622 (1.000)
Step: 128830, Reward: 659.6414 [212.42], Avg: 284.6227 (1.000)
Step: 129830, Reward: 855.2374 [42.66], Avg: 288.6529 (1.000)
Step: 130830, Reward: 615.5020 [269.11], Avg: 289.0903 (1.000)
Step: 131830, Reward: 719.5743 [195.62], Avg: 290.8562 (1.000)
Step: 132830, Reward: 751.7784 [287.57], Avg: 292.1499 (1.000)
Step: 133830, Reward: 695.6328 [214.39], Avg: 293.5506 (1.000)
Step: 134830, Reward: 710.2354 [158.54], Avg: 295.4488 (1.000)
Step: 135830, Reward: 760.8411 [171.89], Avg: 297.5911 (1.000)
Step: 136830, Reward: 693.1992 [225.83], Avg: 298.8214 (1.000)
Step: 137830, Reward: 742.8751 [159.69], Avg: 300.8672 (1.000)
Step: 138830, Reward: 725.1226 [151.96], Avg: 302.8121 (1.000)
Step: 139830, Reward: 723.8368 [177.30], Avg: 304.5406 (1.000)
Step: 140830, Reward: 812.5253 [117.47], Avg: 307.2907 (1.000)
Step: 141830, Reward: 617.9098 [267.82], Avg: 307.5901 (1.000)
Step: 142830, Reward: 651.2993 [114.30], Avg: 309.1832 (1.000)
Step: 143830, Reward: 778.9940 [170.23], Avg: 311.2493 (1.000)
Step: 144830, Reward: 647.4164 [194.46], Avg: 312.2199 (1.000)
Step: 145830, Reward: 739.2981 [209.05], Avg: 313.7031 (1.000)
Step: 146830, Reward: 728.6166 [167.39], Avg: 315.3755 (1.000)
Step: 147830, Reward: 706.0327 [175.40], Avg: 316.8202 (1.000)
Step: 148830, Reward: 809.8198 [119.39], Avg: 319.3110 (1.000)
Step: 149830, Reward: 738.8276 [220.79], Avg: 320.6270 (1.000)
Step: 150830, Reward: 812.4211 [88.16], Avg: 323.2826 (1.000)
Step: 151830, Reward: 729.0532 [167.71], Avg: 324.8385 (1.000)
Step: 152830, Reward: 776.0354 [130.72], Avg: 326.9195 (1.000)
Step: 153830, Reward: 762.6338 [171.09], Avg: 328.6268 (1.000)
Step: 154830, Reward: 873.6299 [34.48], Avg: 331.8994 (1.000)
Step: 155712, Reward: 809.2825 [32.27], Avg: 334.7345 (1.000)
Step: 156712, Reward: 708.1900 [200.41], Avg: 335.8298 (1.000)
Step: 157712, Reward: 683.0518 [206.06], Avg: 336.7176 (1.000)
Step: 158712, Reward: 739.8531 [117.01], Avg: 338.5059 (1.000)
Step: 159712, Reward: 748.7866 [182.46], Avg: 339.9209 (1.000)
Step: 160712, Reward: 655.1353 [209.02], Avg: 340.5765 (1.000)
Step: 161712, Reward: 737.2864 [97.98], Avg: 342.4092 (1.000)
Step: 162712, Reward: 864.0215 [44.53], Avg: 345.3182 (1.000)
Step: 163712, Reward: 692.8132 [164.75], Avg: 346.4257 (1.000)
Step: 164712, Reward: 757.9129 [195.17], Avg: 347.7288 (1.000)
Step: 165712, Reward: 771.3502 [126.21], Avg: 349.5097 (1.000)
Step: 166712, Reward: 866.8968 [13.61], Avg: 352.5083 (1.000)
Step: 167712, Reward: 873.2124 [30.90], Avg: 355.4066 (1.000)
Step: 168712, Reward: 867.6345 [17.14], Avg: 358.3189 (1.000)
Step: 169430, Reward: 810.2907 [69.16], Avg: 360.5575 (1.000)
Step: 170430, Reward: 758.4605 [210.32], Avg: 361.6481 (1.000)
Step: 171430, Reward: 829.1639 [50.35], Avg: 364.0595 (1.000)
Step: 172430, Reward: 897.4806 [22.28], Avg: 366.9970 (1.000)
Step: 173430, Reward: 854.6332 [43.54], Avg: 369.5347 (1.000)
Step: 174430, Reward: 689.7545 [210.46], Avg: 370.1583 (1.000)
Step: 175430, Reward: 832.2619 [72.82], Avg: 372.3577 (1.000)
Step: 176430, Reward: 812.8583 [125.07], Avg: 374.1298 (1.000)
Step: 177430, Reward: 880.9669 [40.12], Avg: 376.7371 (1.000)
Step: 178430, Reward: 779.3862 [159.63], Avg: 378.0872 (1.000)
Step: 179430, Reward: 802.0760 [120.60], Avg: 379.7634 (1.000)
Step: 180430, Reward: 828.5591 [96.21], Avg: 381.7007 (1.000)
Step: 181430, Reward: 872.5042 [12.53], Avg: 384.3142 (1.000)
Step: 182430, Reward: 876.4953 [33.87], Avg: 386.8050 (1.000)
Step: 183430, Reward: 865.0890 [22.03], Avg: 389.2713 (1.000)
Step: 184430, Reward: 852.6412 [61.91], Avg: 391.4297 (1.000)
Step: 185430, Reward: 836.2139 [78.32], Avg: 393.3893 (1.000)
Step: 186430, Reward: 872.7620 [28.05], Avg: 395.7900 (1.000)
Step: 187430, Reward: 876.5508 [35.38], Avg: 398.1465 (1.000)
Step: 188430, Reward: 784.8236 [223.91], Avg: 399.0032 (1.000)
Step: 189430, Reward: 878.8583 [22.81], Avg: 401.3961 (1.000)
Step: 190430, Reward: 847.5624 [59.38], Avg: 403.4106 (1.000)
Step: 191262, Reward: 871.3346 [12.08], Avg: 405.7725 (1.000)
Step: 192262, Reward: 890.1769 [35.13], Avg: 408.0883 (1.000)
Step: 192982, Reward: 768.2634 [201.36], Avg: 408.9027 (1.000)
Step: 193982, Reward: 773.3407 [239.39], Avg: 409.5407 (1.000)
Step: 194982, Reward: 880.9748 [29.23], Avg: 411.7854 (1.000)
Step: 195696, Reward: 857.6344 [18.71], Avg: 413.9427 (1.000)
Step: 196696, Reward: 849.1858 [16.25], Avg: 416.0482 (1.000)
Step: 197696, Reward: 794.0972 [166.20], Avg: 417.1074 (1.000)
Step: 198696, Reward: 873.3325 [16.78], Avg: 419.2937 (1.000)
Step: 199696, Reward: 798.2303 [181.48], Avg: 420.2712 (1.000)
Step: 200696, Reward: 879.6916 [47.86], Avg: 422.2986 (1.000)
Step: 201314, Reward: 801.7849 [92.06], Avg: 423.7076 (1.000)
Step: 202314, Reward: 711.4567 [179.71], Avg: 424.2346 (1.000)
Step: 203314, Reward: 690.3657 [194.51], Avg: 424.5823 (1.000)
Step: 204314, Reward: 880.4851 [27.96], Avg: 426.6496 (1.000)
Step: 205314, Reward: 894.1592 [29.62], Avg: 428.7549 (1.000)
Step: 206314, Reward: 766.9770 [187.09], Avg: 429.4780 (1.000)
Step: 207314, Reward: 882.6607 [40.61], Avg: 431.4427 (1.000)
Step: 208314, Reward: 752.6080 [207.95], Avg: 431.9792 (1.000)
Step: 209314, Reward: 884.5462 [43.04], Avg: 433.9109 (1.000)
Step: 210314, Reward: 662.9718 [293.02], Avg: 433.6107 (1.000)
Step: 211314, Reward: 881.7343 [40.40], Avg: 435.5159 (1.000)
Step: 212314, Reward: 842.2371 [30.90], Avg: 437.2639 (1.000)
Step: 213314, Reward: 841.1470 [10.98], Avg: 439.0829 (1.000)
Step: 214314, Reward: 766.8193 [210.48], Avg: 439.6233 (1.000)
Step: 215061, Reward: 800.1160 [127.66], Avg: 440.6913 (1.000)
Step: 216061, Reward: 893.6026 [23.85], Avg: 442.6505 (1.000)
Step: 216998, Reward: 876.5385 [8.15], Avg: 444.5856 (1.000)
Step: 217998, Reward: 765.0105 [163.56], Avg: 445.2954 (1.000)
Step: 218998, Reward: 852.9387 [66.61], Avg: 446.8316 (1.000)
Step: 219998, Reward: 872.8928 [30.30], Avg: 448.6063 (1.000)
Step: 220998, Reward: 730.8269 [183.66], Avg: 449.0463 (1.000)
Step: 221998, Reward: 791.0129 [240.65], Avg: 449.4966 (1.000)
Step: 222998, Reward: 868.8438 [8.68], Avg: 451.3137 (1.000)
Step: 223998, Reward: 830.9104 [95.29], Avg: 452.5661 (1.000)
Step: 224998, Reward: 781.6267 [97.74], Avg: 453.5807 (1.000)
Step: 225795, Reward: 869.2269 [43.38], Avg: 455.2063 (1.000)
Step: 226795, Reward: 891.6404 [29.62], Avg: 456.9751 (1.000)
Step: 227675, Reward: 826.5746 [74.13], Avg: 458.2542 (1.000)
Step: 228675, Reward: 795.3433 [108.82], Avg: 459.2381 (1.000)
Step: 229675, Reward: 717.0661 [186.50], Avg: 459.5442 (1.000)
Step: 230675, Reward: 633.9865 [166.15], Avg: 459.5796 (1.000)
Step: 231675, Reward: 807.7288 [134.91], Avg: 460.4870 (1.000)
Step: 232675, Reward: 807.0153 [160.58], Avg: 461.2749 (1.000)
Step: 233675, Reward: 898.7000 [30.22], Avg: 462.9931 (1.000)
Step: 234675, Reward: 824.5182 [162.76], Avg: 463.8283 (1.000)
Step: 235675, Reward: 702.9588 [256.46], Avg: 463.7557 (1.000)
Step: 236539, Reward: 755.1507 [254.35], Avg: 463.9101 (1.000)
Step: 237245, Reward: 864.7346 [73.44], Avg: 465.2685 (1.000)
Step: 237910, Reward: 885.8832 [43.20], Avg: 466.8281 (1.000)
Step: 238910, Reward: 864.8937 [17.18], Avg: 468.3955 (1.000)
Step: 239801, Reward: 857.5629 [15.00], Avg: 469.9290 (1.000)
Step: 240801, Reward: 800.7235 [212.70], Avg: 470.4110 (1.000)
Step: 241494, Reward: 849.2591 [76.17], Avg: 471.6415 (1.000)
Step: 242494, Reward: 812.8066 [67.52], Avg: 472.7493 (1.000)
Step: 243494, Reward: 871.1031 [12.78], Avg: 474.3040 (1.000)
Step: 244494, Reward: 872.5461 [41.14], Avg: 475.7382 (1.000)
Step: 245494, Reward: 871.4204 [25.00], Avg: 477.2209 (1.000)
Step: 246494, Reward: 866.2194 [53.77], Avg: 478.5565 (1.000)
Step: 247313, Reward: 865.9205 [20.00], Avg: 480.0142 (1.000)
Step: 248313, Reward: 880.5277 [35.53], Avg: 481.4569 (1.000)
Step: 249190, Reward: 883.0916 [29.22], Avg: 482.9231 (1.000)
Step: 249923, Reward: 881.8340 [36.47], Avg: 484.3444 (1.000)
Step: 250636, Reward: 886.0842 [14.17], Avg: 485.8584 (1.000)
Step: 251636, Reward: 881.7089 [35.31], Avg: 487.2612 (1.000)
Step: 252479, Reward: 856.6525 [46.28], Avg: 488.5136 (1.000)
Step: 253479, Reward: 845.4725 [76.50], Avg: 489.5965 (1.000)
Step: 254479, Reward: 888.2698 [25.23], Avg: 491.0328 (1.000)
Step: 255479, Reward: 853.4828 [18.10], Avg: 492.3521 (1.000)
Step: 256479, Reward: 878.2779 [26.61], Avg: 493.7235 (1.000)
Step: 257479, Reward: 891.8806 [43.39], Avg: 495.0724 (1.000)
Step: 258479, Reward: 820.0276 [184.53], Avg: 495.6044 (1.000)
Step: 259314, Reward: 777.3894 [147.57], Avg: 496.1108 (1.000)
Step: 260314, Reward: 872.2986 [16.43], Avg: 497.4633 (1.000)
Step: 261314, Reward: 860.7741 [34.16], Avg: 498.6960 (1.000)
Step: 262314, Reward: 820.4290 [62.82], Avg: 499.6621 (1.000)
Step: 263314, Reward: 868.6881 [5.86], Avg: 501.0122 (1.000)
Step: 264314, Reward: 785.7712 [177.30], Avg: 501.4102 (1.000)
Step: 265314, Reward: 718.7368 [214.59], Avg: 501.4202 (1.000)
Step: 266314, Reward: 829.6385 [56.54], Avg: 502.4190 (1.000)
Step: 267314, Reward: 801.1588 [87.77], Avg: 503.1918 (1.000)
Step: 268314, Reward: 865.2150 [7.92], Avg: 504.4842 (1.000)
Step: 269314, Reward: 843.8983 [18.06], Avg: 505.6527 (1.000)
Step: 270097, Reward: 876.8070 [47.20], Avg: 506.8265 (1.000)
Step: 271097, Reward: 790.4275 [153.08], Avg: 507.2977 (1.000)
Step: 272097, Reward: 766.4081 [174.21], Avg: 507.6031 (1.000)
Step: 272871, Reward: 794.3306 [163.85], Avg: 508.0435 (1.000)
Step: 273871, Reward: 839.6903 [25.36], Avg: 509.1374 (1.000)
Step: 274871, Reward: 761.1676 [224.50], Avg: 509.2354 (1.000)
Step: 275871, Reward: 837.6537 [74.43], Avg: 510.1361 (1.000)
Step: 276871, Reward: 839.5918 [38.06], Avg: 511.1657 (1.000)
Step: 277871, Reward: 742.0441 [220.92], Avg: 511.2008 (1.000)
Step: 278871, Reward: 808.8073 [141.72], Avg: 511.7478 (1.000)
Step: 279871, Reward: 808.6720 [153.70], Avg: 512.2486 (1.000)
Step: 280871, Reward: 752.5419 [205.46], Avg: 512.3699 (1.000)
Step: 281871, Reward: 793.6884 [81.14], Avg: 513.0650 (1.000)
Step: 282871, Reward: 749.3196 [102.57], Avg: 513.5276 (1.000)
Step: 283871, Reward: 751.9289 [177.21], Avg: 513.7386 (1.000)
Step: 284871, Reward: 747.1818 [139.70], Avg: 514.0607 (1.000)
Step: 285871, Reward: 652.1123 [196.91], Avg: 513.8591 (1.000)
Step: 286871, Reward: 872.8696 [30.14], Avg: 514.9816 (1.000)
Step: 287871, Reward: 842.6900 [57.33], Avg: 515.9012 (1.000)
Step: 288871, Reward: 818.1333 [75.65], Avg: 516.6693 (1.000)
Step: 289871, Reward: 849.1070 [17.03], Avg: 517.7348 (1.000)
Step: 290626, Reward: 877.4998 [33.94], Avg: 518.8319 (1.000)
Step: 291393, Reward: 826.6794 [40.45], Avg: 519.7292 (1.000)
Step: 292393, Reward: 886.7527 [42.84], Avg: 520.8134 (1.000)
Step: 293393, Reward: 850.5910 [41.25], Avg: 521.7752 (1.000)
Step: 294393, Reward: 765.0676 [153.39], Avg: 522.0739 (1.000)
Step: 295393, Reward: 814.2747 [88.90], Avg: 522.7471 (1.000)
Step: 296393, Reward: 695.8739 [225.03], Avg: 522.5757 (1.000)
Step: 297393, Reward: 754.0995 [111.32], Avg: 522.9712 (1.000)
Step: 298393, Reward: 854.7125 [23.12], Avg: 523.9830 (1.000)
Step: 299393, Reward: 675.4351 [282.85], Avg: 523.5536 (1.000)
Step: 300393, Reward: 850.4890 [51.58], Avg: 524.4505 (1.000)
Step: 301393, Reward: 877.6632 [29.21], Avg: 525.5025 (1.000)
Step: 302393, Reward: 755.5910 [239.48], Avg: 525.4721 (1.000)
Step: 303393, Reward: 854.9126 [28.64], Avg: 526.4424 (1.000)
Step: 304393, Reward: 829.8306 [92.47], Avg: 527.1206 (1.000)
Step: 305393, Reward: 873.7100 [16.74], Avg: 528.1778 (1.000)
Step: 306393, Reward: 892.2985 [34.39], Avg: 529.2312 (1.000)
Step: 307393, Reward: 772.0586 [217.13], Avg: 529.3131 (1.000)
Step: 308393, Reward: 857.4643 [28.49], Avg: 530.2644 (1.000)
Step: 309393, Reward: 848.9836 [23.38], Avg: 531.1990 (1.000)
Step: 310393, Reward: 827.4606 [50.49], Avg: 531.9743 (1.000)
Step: 311393, Reward: 762.6936 [224.89], Avg: 531.9927 (1.000)
Step: 312393, Reward: 808.6597 [131.02], Avg: 532.4492 (1.000)
Step: 313133, Reward: 869.8046 [23.91], Avg: 533.4287 (1.000)
Step: 314133, Reward: 867.7525 [24.31], Avg: 534.3945 (1.000)
Step: 315133, Reward: 752.5273 [253.51], Avg: 534.2846 (1.000)
Step: 316133, Reward: 846.6454 [30.98], Avg: 535.1558 (1.000)
Step: 317133, Reward: 735.1588 [171.45], Avg: 535.2439 (1.000)
Step: 318133, Reward: 787.2784 [119.41], Avg: 535.6520 (1.000)
Step: 318854, Reward: 881.4024 [41.46], Avg: 536.5854 (1.000)
Step: 319854, Reward: 870.3780 [32.11], Avg: 537.5079 (1.000)
Step: 320854, Reward: 751.0621 [207.52], Avg: 537.5263 (1.000)
Step: 321854, Reward: 863.4568 [32.70], Avg: 538.4176 (1.000)
Step: 322854, Reward: 781.2135 [93.93], Avg: 538.8687 (1.000)
Step: 323854, Reward: 903.9819 [28.86], Avg: 539.8846 (1.000)
Step: 324854, Reward: 885.5750 [19.37], Avg: 540.8674 (1.000)
Step: 325854, Reward: 870.7163 [17.37], Avg: 541.8058 (1.000)
Step: 326854, Reward: 885.0404 [22.62], Avg: 542.7658 (1.000)
Step: 327589, Reward: 867.6855 [34.21], Avg: 543.6335 (1.000)
Step: 328589, Reward: 878.9449 [9.75], Avg: 544.6025 (1.000)
Step: 329280, Reward: 903.8681 [19.48], Avg: 545.6107 (1.000)
Step: 330037, Reward: 879.6259 [29.73], Avg: 546.5110 (1.000)
Step: 330746, Reward: 910.7666 [12.75], Avg: 547.5479 (1.000)
Step: 331746, Reward: 875.6470 [14.16], Avg: 548.4712 (1.000)
Step: 332746, Reward: 773.8818 [236.48], Avg: 548.4388 (1.000)
Step: 333746, Reward: 856.2820 [36.21], Avg: 549.2330 (1.000)
Step: 334746, Reward: 805.0952 [119.31], Avg: 549.6311 (1.000)
Step: 335746, Reward: 864.1717 [19.77], Avg: 550.4880 (1.000)
Step: 336746, Reward: 889.0664 [17.81], Avg: 551.4178 (1.000)
Step: 337746, Reward: 767.6414 [123.38], Avg: 551.6861 (1.000)
Step: 338746, Reward: 723.5673 [261.68], Avg: 551.4273 (1.000)
Step: 339746, Reward: 683.5068 [270.87], Avg: 551.0285 (1.000)
Step: 340746, Reward: 705.6687 [214.75], Avg: 550.8562 (1.000)
Step: 341746, Reward: 901.1831 [28.81], Avg: 551.7749 (1.000)
Step: 342746, Reward: 912.3247 [21.48], Avg: 552.7409 (1.000)
Step: 343746, Reward: 851.8455 [42.70], Avg: 553.4693 (1.000)
Step: 344746, Reward: 886.7043 [33.46], Avg: 554.3185 (1.000)
Step: 345357, Reward: 708.1428 [226.72], Avg: 554.1126 (1.000)
Step: 346357, Reward: 807.2750 [215.20], Avg: 554.2195 (1.000)
Step: 347357, Reward: 697.7079 [291.07], Avg: 553.8050 (1.000)
Step: 348046, Reward: 875.5233 [35.66], Avg: 554.6062 (1.000)
Step: 349046, Reward: 775.9586 [201.31], Avg: 554.6622 (1.000)
Step: 350046, Reward: 848.4655 [67.69], Avg: 555.2921 (1.000)
Step: 351046, Reward: 851.6471 [43.89], Avg: 555.9933 (1.000)
Step: 352046, Reward: 879.9162 [20.88], Avg: 556.8328 (1.000)
Step: 353046, Reward: 787.7146 [155.04], Avg: 557.0423 (1.000)
Step: 354046, Reward: 886.4212 [26.88], Avg: 557.8756 (1.000)
Step: 355046, Reward: 808.6734 [128.06], Avg: 558.2128 (1.000)
Step: 356046, Reward: 883.6571 [64.09], Avg: 558.9289 (1.000)
Step: 357046, Reward: 821.0916 [103.35], Avg: 559.3628 (1.000)
Step: 358046, Reward: 804.0716 [106.15], Avg: 559.7403 (1.000)
Step: 359046, Reward: 748.5560 [265.53], Avg: 559.5319 (1.000)
Step: 360046, Reward: 879.5814 [8.02], Avg: 560.3775 (1.000)
Step: 361046, Reward: 762.0576 [195.48], Avg: 560.3942 (1.000)
Step: 362046, Reward: 898.9027 [29.13], Avg: 561.2281 (1.000)
Step: 363046, Reward: 790.0846 [107.46], Avg: 561.5544 (1.000)
Step: 364046, Reward: 852.5666 [48.75], Avg: 562.2039 (1.000)
Step: 365046, Reward: 830.3637 [23.71], Avg: 562.8575 (1.000)
Step: 365758, Reward: 733.8494 [255.23], Avg: 562.6329 (1.000)
Step: 366478, Reward: 829.7130 [24.52], Avg: 563.2780 (1.000)
Step: 367478, Reward: 829.9425 [122.21], Avg: 563.6612 (1.000)
Step: 368478, Reward: 703.6750 [289.19], Avg: 563.2665 (1.000)
Step: 369478, Reward: 856.2431 [20.48], Avg: 563.9855 (1.000)
Step: 370431, Reward: 767.8930 [201.24], Avg: 563.9925 (1.000)
Step: 371431, Reward: 813.1713 [95.07], Avg: 564.3970 (1.000)
Step: 372431, Reward: 883.9236 [39.23], Avg: 565.1308 (1.000)
Step: 373124, Reward: 859.6658 [50.08], Avg: 565.7691 (1.000)
Step: 374124, Reward: 893.1787 [38.09], Avg: 566.5225 (1.000)
Step: 375124, Reward: 824.5371 [112.23], Avg: 566.9011 (1.000)
Step: 376124, Reward: 893.6623 [50.98], Avg: 567.6156 (1.000)
Step: 377124, Reward: 882.1948 [35.34], Avg: 568.3372 (1.000)
Step: 378124, Reward: 899.0657 [51.62], Avg: 569.0565 (1.000)
Step: 379124, Reward: 887.3688 [37.98], Avg: 569.7772 (1.000)
Step: 380124, Reward: 902.0269 [23.13], Avg: 570.5698 (1.000)
Step: 380928, Reward: 732.4792 [177.69], Avg: 570.5294 (1.000)
Step: 381928, Reward: 858.9652 [74.10], Avg: 571.0762 (1.000)
Step: 382928, Reward: 845.7462 [67.84], Avg: 571.6025 (1.000)
Step: 383659, Reward: 763.7141 [172.31], Avg: 571.6527 (1.000)
Step: 384373, Reward: 741.9238 [250.49], Avg: 571.4496 (1.000)
Step: 385057, Reward: 890.5042 [35.26], Avg: 572.1663 (1.000)
Step: 386057, Reward: 880.1224 [22.98], Avg: 572.8841 (1.000)
Step: 386866, Reward: 876.8759 [9.37], Avg: 573.6244 (1.000)
Step: 387866, Reward: 922.3064 [18.11], Avg: 574.4529 (1.000)
Step: 388585, Reward: 877.8729 [30.57], Avg: 575.1350 (1.000)
Step: 389356, Reward: 874.3127 [35.86], Avg: 575.7916 (1.000)
Step: 390146, Reward: 905.9865 [22.86], Avg: 576.5561 (1.000)
Step: 391146, Reward: 899.0682 [22.44], Avg: 577.3007 (1.000)
Step: 391905, Reward: 846.3238 [43.26], Avg: 577.8596 (1.000)
Step: 392905, Reward: 734.8418 [270.06], Avg: 577.5804 (1.000)
Step: 393905, Reward: 906.0477 [21.37], Avg: 578.3368 (1.000)
Step: 394905, Reward: 903.7661 [41.51], Avg: 579.0344 (1.000)
Step: 395905, Reward: 722.2922 [195.26], Avg: 578.9069 (1.000)
Step: 396905, Reward: 898.3072 [30.18], Avg: 579.6140 (1.000)
Step: 397905, Reward: 776.3771 [165.40], Avg: 579.6905 (1.000)
Step: 398905, Reward: 884.1780 [32.15], Avg: 580.3531 (1.000)
Step: 399697, Reward: 834.6245 [83.87], Avg: 580.7667 (1.000)
Step: 400697, Reward: 877.0845 [11.75], Avg: 581.4558 (1.000)
Step: 401697, Reward: 770.3531 [247.89], Avg: 581.3133 (1.000)
Step: 402697, Reward: 876.4631 [16.42], Avg: 581.9849 (1.000)
Step: 403423, Reward: 887.8660 [27.14], Avg: 582.6550 (1.000)
Step: 404423, Reward: 883.2988 [27.53], Avg: 583.3099 (1.000)
Step: 405423, Reward: 736.1563 [169.10], Avg: 583.2710 (1.000)
Step: 406423, Reward: 870.2512 [48.93], Avg: 583.8392 (1.000)
Step: 407423, Reward: 842.7248 [65.63], Avg: 584.2993 (1.000)
Step: 408423, Reward: 862.6051 [70.37], Avg: 584.7932 (1.000)
Step: 409005, Reward: 870.5735 [9.11], Avg: 585.4488 (1.000)
Step: 409753, Reward: 858.0601 [26.63], Avg: 586.0304 (1.000)
Step: 410753, Reward: 807.2162 [110.42], Avg: 586.2916 (1.000)
Step: 411753, Reward: 886.3986 [40.67], Avg: 586.9020 (1.000)
Step: 412753, Reward: 861.7115 [21.46], Avg: 587.4968 (1.000)
Step: 413753, Reward: 834.3312 [39.35], Avg: 587.9827 (1.000)
Step: 414753, Reward: 890.8481 [28.22], Avg: 588.6244 (1.000)
Step: 415753, Reward: 758.4411 [224.88], Avg: 588.4960 (1.000)
Step: 416753, Reward: 834.2647 [49.88], Avg: 588.9516 (1.000)
Step: 417753, Reward: 866.0612 [38.65], Avg: 589.5048 (1.000)
Step: 418441, Reward: 859.5190 [20.40], Avg: 590.0826 (1.000)
Step: 419237, Reward: 802.7816 [175.97], Avg: 590.1675 (1.000)
Step: 420237, Reward: 872.2328 [28.37], Avg: 590.7520 (1.000)
Step: 421237, Reward: 871.1302 [19.38], Avg: 591.3520 (1.000)
Step: 422237, Reward: 879.3710 [19.28], Avg: 591.9684 (1.000)
Step: 423237, Reward: 887.9276 [25.91], Avg: 592.5863 (1.000)
Step: 423950, Reward: 885.0986 [49.05], Avg: 593.1422 (1.000)
Step: 424687, Reward: 876.4975 [37.13], Avg: 593.7031 (1.000)
Step: 425687, Reward: 887.2491 [45.70], Avg: 594.2663 (1.000)
Step: 426687, Reward: 876.1371 [35.18], Avg: 594.8257 (1.000)
Step: 427687, Reward: 839.8673 [92.69], Avg: 595.1704 (1.000)
Step: 428687, Reward: 821.9086 [52.90], Avg: 595.5628 (1.000)
Step: 429687, Reward: 882.7166 [12.53], Avg: 596.1814 (1.000)
Step: 430381, Reward: 887.9099 [23.13], Avg: 596.7850 (1.000)
Step: 431381, Reward: 769.1242 [204.42], Avg: 596.7130 (1.000)
Step: 432381, Reward: 851.7354 [65.89], Avg: 597.1362 (1.000)
Step: 433381, Reward: 877.8442 [49.82], Avg: 597.6515 (1.000)
Step: 434381, Reward: 906.1070 [30.24], Avg: 598.2712 (1.000)
Step: 435381, Reward: 733.8748 [209.20], Avg: 598.1076 (1.000)
Step: 436381, Reward: 831.5239 [120.98], Avg: 598.3569 (1.000)
Step: 437381, Reward: 917.4770 [28.23], Avg: 599.0005 (1.000)
Step: 438381, Reward: 867.0099 [35.01], Avg: 599.5148 (1.000)
Step: 439381, Reward: 848.7994 [87.02], Avg: 599.8722 (1.000)
Step: 440381, Reward: 806.9722 [99.80], Avg: 600.1081 (1.000)
Step: 441381, Reward: 852.2902 [7.74], Avg: 600.6441 (1.000)
Step: 442381, Reward: 908.5604 [19.95], Avg: 601.2743 (1.000)
Step: 443381, Reward: 860.8110 [27.96], Avg: 601.7799 (1.000)
Step: 444381, Reward: 882.0235 [14.46], Avg: 602.3589 (1.000)
Step: 445381, Reward: 793.4988 [166.36], Avg: 602.4128 (1.000)
Step: 446381, Reward: 800.9792 [137.77], Avg: 602.5447 (1.000)
Step: 447381, Reward: 862.2419 [44.05], Avg: 603.0115 (1.000)
Step: 448381, Reward: 877.9140 [12.74], Avg: 603.5777 (1.000)
Step: 448982, Reward: 885.7807 [18.77], Avg: 604.1454 (1.000)
Step: 449696, Reward: 883.3427 [23.04], Avg: 604.6963 (1.000)
Step: 450561, Reward: 903.3728 [27.56], Avg: 605.2781 (1.000)
Step: 451190, Reward: 903.6239 [20.89], Avg: 605.8722 (1.000)
Step: 451795, Reward: 825.1060 [150.71], Avg: 606.0187 (1.000)
Step: 452795, Reward: 903.1648 [19.39], Avg: 606.6109 (1.000)
Step: 453422, Reward: 908.5309 [32.19], Avg: 607.1848 (1.000)
Step: 454295, Reward: 896.8388 [29.70], Avg: 607.7367 (1.000)
Step: 455085, Reward: 893.0097 [26.19], Avg: 608.2856 (1.000)
Step: 456085, Reward: 881.9935 [11.57], Avg: 608.8398 (1.000)
Step: 457085, Reward: 858.5430 [84.32], Avg: 609.1887 (1.000)
Step: 458085, Reward: 903.5226 [22.82], Avg: 609.7603 (1.000)
Step: 459085, Reward: 874.6186 [58.30], Avg: 610.1943 (1.000)
Step: 460085, Reward: 889.2544 [8.02], Avg: 610.7625 (1.000)
Step: 461085, Reward: 901.8096 [22.48], Avg: 611.3244 (1.000)
Step: 462085, Reward: 840.1500 [83.99], Avg: 611.6267 (1.000)
Step: 462907, Reward: 881.2954 [25.31], Avg: 612.1358 (1.000)
Step: 463907, Reward: 878.4089 [26.38], Avg: 612.6345 (1.000)
Step: 464541, Reward: 855.6475 [50.84], Avg: 613.0332 (1.000)
Step: 465541, Reward: 631.1879 [321.10], Avg: 612.4060 (1.000)
Step: 466541, Reward: 894.1453 [20.00], Avg: 612.9468 (1.000)
Step: 467541, Reward: 795.8087 [172.88], Avg: 612.9674 (1.000)
Step: 468541, Reward: 898.8776 [29.21], Avg: 613.4956 (1.000)
Step: 469343, Reward: 894.2998 [29.14], Avg: 614.0124 (1.000)
Step: 470343, Reward: 877.4669 [52.88], Avg: 614.4439 (1.000)
Step: 470968, Reward: 887.6222 [23.36], Avg: 614.9547 (1.000)
Step: 471584, Reward: 903.5011 [33.02], Avg: 615.4762 (1.000)
Step: 472584, Reward: 906.8316 [29.90], Avg: 616.0087 (1.000)
Step: 473584, Reward: 666.3855 [247.44], Avg: 615.6082 (1.000)
Step: 474381, Reward: 848.2239 [53.42], Avg: 615.9717 (1.000)
Step: 475363, Reward: 889.4842 [23.74], Avg: 616.4773 (1.000)
Step: 476016, Reward: 844.1841 [67.12], Avg: 616.8017 (1.000)
Step: 477016, Reward: 850.3587 [70.20], Avg: 617.1311 (1.000)
Step: 477877, Reward: 895.1657 [31.37], Avg: 617.6274 (1.000)
Step: 478877, Reward: 862.9754 [29.46], Avg: 618.0609 (1.000)
Step: 479467, Reward: 860.1051 [87.06], Avg: 618.3715 (1.000)
Step: 480467, Reward: 874.4006 [30.31], Avg: 618.8229 (1.000)
Step: 481467, Reward: 863.6238 [24.57], Avg: 619.2625 (1.000)
Step: 482467, Reward: 879.1634 [28.11], Avg: 619.7242 (1.000)
Step: 483125, Reward: 809.2116 [161.99], Avg: 619.7789 (1.000)
Step: 484125, Reward: 836.0011 [40.26], Avg: 620.1280 (1.000)
Step: 485125, Reward: 859.0145 [25.78], Avg: 620.5500 (1.000)
Step: 485715, Reward: 896.6779 [36.72], Avg: 621.0231 (1.000)
Step: 486715, Reward: 848.2709 [33.09], Avg: 621.4061 (1.000)
Step: 487715, Reward: 854.5950 [133.75], Avg: 621.6018 (1.000)
Step: 488715, Reward: 890.0825 [18.43], Avg: 622.0931 (1.000)
Step: 489410, Reward: 870.9161 [7.45], Avg: 622.5663 (1.000)
Step: 490410, Reward: 861.7389 [99.73], Avg: 622.8392 (1.000)
Step: 491410, Reward: 877.2984 [32.13], Avg: 623.2735 (1.000)
Step: 492054, Reward: 900.8212 [29.91], Avg: 623.7562 (1.000)
Step: 493054, Reward: 865.3538 [23.51], Avg: 624.1805 (1.000)
Step: 494054, Reward: 875.2978 [46.40], Avg: 624.5780 (1.000)
Step: 495054, Reward: 884.9241 [15.81], Avg: 625.0519 (1.000)
Step: 496002, Reward: 887.9416 [27.98], Avg: 625.5063 (1.000)
Step: 497002, Reward: 750.2293 [179.75], Avg: 625.4000 (1.000)
Step: 498002, Reward: 883.7375 [47.22], Avg: 625.8068 (1.000)
Step: 498621, Reward: 808.3114 [154.85], Avg: 625.8600 (1.000)
Step: 499621, Reward: 887.3611 [22.94], Avg: 626.3179 (1.000)
